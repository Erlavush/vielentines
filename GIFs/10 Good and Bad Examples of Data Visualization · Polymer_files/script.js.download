
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="df1fd97b-9bae-55ac-8490-c8b59211ed9e")}catch(e){}}();
(()=>{"use strict";const e="10.1.0",t=globalThis;function n(){return r(t),t}function r(t){const n=t.__SENTRY__=t.__SENTRY__||{};return n.version=n.version||e,n[e]=n[e]||{}}function i(n,r,i=t){const s=i.__SENTRY__=i.__SENTRY__||{},o=s[e]=s[e]||{};return o[n]||(o[n]=r())}const s="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,o=Object.prototype.toString;function a(e){switch(o.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return v(e,Error)}}function c(e,t){return o.call(e)===`[object ${t}]`}function u(e){return c(e,"ErrorEvent")}function l(e){return c(e,"DOMError")}function d(e){return c(e,"String")}function p(e){return"object"==typeof e&&null!==e&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function f(e){return c(e,"Object")}function h(e){return"undefined"!=typeof Event&&v(e,Event)}function g(e){return Boolean(e?.then&&"function"==typeof e.then)}function v(e,t){try{return e instanceof t}catch{return!1}}const m=t,b=80;function y(e,t){const n=e,r=[];if(!n?.tagName)return"";if(m.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const i=t?.length?t.filter((e=>n.getAttribute(e))).map((e=>[e,n.getAttribute(e)])):null;if(i?.length)i.forEach((e=>{r.push(`[${e[0]}="${e[1]}"]`)}));else{n.id&&r.push(`#${n.id}`);const e=n.className;if(e&&d(e)){const t=e.split(/\s+/);for(const e of t)r.push(`.${e}`)}}const s=["aria-label","type","name","title","alt"];for(const e of s){const t=n.getAttribute(e);t&&r.push(`[${e}="${t}"]`)}return r.join("")}const _={};function w(e){if(!("console"in t))return e();const n=t.console,r={},i=Object.keys(_);i.forEach((e=>{const t=_[e];r[e]=n[e],n[e]=t}));try{return e()}finally{i.forEach((e=>{n[e]=r[e]}))}}function E(){return O().enabled}function S(...e){I("error",...e)}function I(e,...n){s&&E()&&w((()=>{t.console[e](`Sentry Logger [${e}]:`,...n)}))}function O(){return s?i("loggerSettings",(()=>({enabled:!1}))):{enabled:!1}}const x={enable:function(){O().enabled=!0},disable:function(){O().enabled=!1},isEnabled:E,log:function(...e){I("log",...e)},warn:function(...e){I("warn",...e)},error:function(...e){I("error",...e)}};function k(e,t=0){return"string"!=typeof e||0===t||e.length<=t?e:`${e.slice(0,t)}...`}function T(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch{s&&x.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function C(e){if(a(e))return{message:e.message,name:e.name,stack:e.stack,...D(e)};if(h(e)){const t={type:e.type,target:A(e.target),currentTarget:A(e.currentTarget),...D(e)};return"undefined"!=typeof CustomEvent&&v(e,CustomEvent)&&(t.detail=e.detail),t}return e}function A(e){try{return"undefined"!=typeof Element&&v(e,Element)?function(e,t={}){if(!e)return"<unknown>";try{let n=e;const r=5,i=[];let s=0,o=0;const a=" > ",c=a.length;let u;const l=Array.isArray(t)?t:t.keyAttrs,d=!Array.isArray(t)&&t.maxStringLength||b;for(;n&&s++<r&&(u=y(n,l),!("html"===u||s>1&&o+i.length*c+u.length>=d));)i.push(u),o+=u.length,n=n.parentNode;return i.reverse().join(a)}catch{return"<unknown>"}}(e):Object.prototype.toString.call(e)}catch{return"<unknown>"}}function D(e){if("object"==typeof e&&null!==e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}return{}}function P(e=function(){const e=t;return e.crypto||e.msCrypto}()){let n=()=>16*Math.random();try{if(e?.randomUUID)return e.randomUUID().replace(/-/g,"");e?.getRandomValues&&(n=()=>{const t=new Uint8Array(1);return e.getRandomValues(t),t[0]})}catch{}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,(e=>(e^(15&n())>>e/4).toString(16)))}function R(e,t,n){const r=e.exception=e.exception||{},i=r.values=r.values||[],s=i[0]=i[0]||{};s.value||(s.value=t||""),s.type||(s.type=n||"Error")}function F(e,t){const n=function(e){return e.exception?.values?.[0]}(e);if(!n)return;const r=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...r,...t},t&&"data"in t){const e={...r?.data,...t.data};n.mechanism.data=e}}function N(e){if(function(e){try{return e.__sentry_captured__}catch{}}(e))return!0;try{T(e,"__sentry_captured__",!0)}catch{}return!1}const L=1e3;function M(){return Date.now()/L}let U;function z(){return(U??(U=function(){const{performance:e}=t;if(!e?.now||!e.timeOrigin)return M;const n=e.timeOrigin;return()=>(n+e.now())/L}()))()}function $(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),e.did||t.did||(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||z(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=32===t.sid.length?t.sid:P()),void 0!==t.init&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),"number"==typeof t.started&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if("number"==typeof t.duration)e.duration=t.duration;else{const t=e.timestamp-e.started;e.duration=t>=0?t:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),"number"==typeof t.errors&&(e.errors=t.errors),t.status&&(e.status=t.status)}function j(e,t,n=2){if(!t||"object"!=typeof t||n<=0)return t;if(e&&0===Object.keys(t).length)return e;const r={...e};for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=j(r[e],t[e],n-1));return r}function B(){return P()}function V(){return P().substring(16)}const W="_sentrySpan";function H(e,t){t?T(e,W,t):delete e[W]}function K(e){return e[W]}class G{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:B(),sampleRand:Math.random()}}clone(){const e=new G;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,H(e,K(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&$(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return null===t?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const t="function"==typeof e?e(this):e,n=t instanceof G?t.getScopeData():f(t)?e:void 0,{tags:r,extra:i,user:s,contexts:o,level:a,fingerprint:c=[],propagationContext:u}=n||{};return this._tags={...this._tags,...r},this._extra={...this._extra,...i},this._contexts={...this._contexts,...o},s&&Object.keys(s).length&&(this._user=s),a&&(this._level=a),c.length&&(this._fingerprint=c),u&&(this._propagationContext=u),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,H(this,void 0),this._attachments=[],this.setPropagationContext({traceId:B(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(e,t){const n="number"==typeof t?t:100;if(n<=0)return this;const r={timestamp:M(),...e,message:e.message?k(e.message,2048):e.message};return this._breadcrumbs.push(r),this._breadcrumbs.length>n&&(this._breadcrumbs=this._breadcrumbs.slice(-n),this._client?.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:K(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=j(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,t){const n=t?.event_id||P();if(!this._client)return s&&x.warn("No client configured on scope - will not capture exception!"),n;const r=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:r,...t,event_id:n},this),n}captureMessage(e,t,n){const r=n?.event_id||P();if(!this._client)return s&&x.warn("No client configured on scope - will not capture message!"),r;const i=new Error(e);return this._client.captureMessage(e,t,{originalException:e,syntheticException:i,...n,event_id:r},this),r}captureEvent(e,t){const n=t?.event_id||P();return this._client?(this._client.captureEvent(e,{...t,event_id:n},this),n):(s&&x.warn("No client configured on scope - will not capture event!"),n)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((e=>{e(this)})),this._notifyingListeners=!1)}}class Y{constructor(e,t){let n,r;n=e||new G,r=t||new G,this._stack=[{scope:n}],this._isolationScope=r}withScope(e){const t=this._pushScope();let n;try{n=e(t)}catch(e){throw this._popScope(),e}return g(n)?n.then((e=>(this._popScope(),e)),(e=>{throw this._popScope(),e})):(this._popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return!(this._stack.length<=1||!this._stack.pop())}}function J(){const e=r(n());return e.stack=e.stack||new Y(i("defaultCurrentScope",(()=>new G)),i("defaultIsolationScope",(()=>new G)))}function q(e){return J().withScope(e)}function X(e,t){const n=J();return n.withScope((()=>(n.getStackTop().scope=e,t(e))))}function Z(e){return J().withScope((()=>e(J().getIsolationScope())))}function Q(e){const t=r(e);return t.acs?t.acs:{withIsolationScope:Z,withScope:q,withSetScope:X,withSetIsolationScope:(e,t)=>Z(t),getCurrentScope:()=>J().getScope(),getIsolationScope:()=>J().getIsolationScope()}}function ee(){return Q(n()).getCurrentScope()}function te(){return Q(n()).getIsolationScope()}function ne(){return ee().getClient()}function re(e){const t=e.getPropagationContext(),{traceId:n,parentSpanId:r,propagationSpanId:i}=t,s={trace_id:n,span_id:i||V()};return r&&(s.parent_span_id=r),s}function ie(e,t){te().setTag(e,t)}const se="production",oe=/^o(\d+)\./,ae=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function ce(e,t=!1){const{host:n,path:r,pass:i,port:s,projectId:o,protocol:a,publicKey:c}=e;return`${a}://${c}${t&&i?`:${i}`:""}@${n}${s?`:${s}`:""}/${r?`${r}/`:r}${o}`}function ue(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function le(e){const t=e.getOptions(),{host:n}=e.getDsn()||{};let r;return t.orgId?r=String(t.orgId):n&&(r=function(e){const t=e.match(oe);return t?.[1]}(n)),r}const de="?",pe=/\(error: (.*)\)/,fe=/captureMessage|captureException/;function he(e){return e[e.length-1]||{}}const ge="<anonymous>";function ve(e,t=100,n=1/0){try{return be("",e,t,n)}catch(e){return{ERROR:`**non-serializable** (${e})`}}}function me(e,t=3,n=102400){const r=ve(e,t);return i=r,function(e){return~-encodeURI(e).split(/%..|./).length}(JSON.stringify(i))>n?me(e,t-1,n):r;var i}function be(e,t,n=1/0,r=1/0,i=function(){const e=new WeakSet;return[function(t){return!!e.has(t)||(e.add(t),!1)},function(t){e.delete(t)}]}()){const[s,o]=i;if(null==t||["boolean","string"].includes(typeof t)||"number"==typeof t&&Number.isFinite(t))return t;const a=function(e,t){try{if("domain"===e&&t&&"object"==typeof t&&t._events)return"[Domain]";if("domainEmitter"===e)return"[DomainEmitter]";if("undefined"!=typeof global&&t===global)return"[Global]";if("undefined"!=typeof window&&t===window)return"[Window]";if("undefined"!=typeof document&&t===document)return"[Document]";if("object"==typeof(n=t)&&null!==n&&(n.__isVue||n._isVue))return"[VueViewModel]";if(function(e){return f(e)&&"nativeEvent"in e&&"preventDefault"in e&&"stopPropagation"in e}(t))return"[SyntheticEvent]";if("number"==typeof t&&!Number.isFinite(t))return`[${t}]`;if("function"==typeof t)return`[Function: ${function(e){try{return e&&"function"==typeof e&&e.name||ge}catch{return ge}}(t)}]`;if("symbol"==typeof t)return`[${String(t)}]`;if("bigint"==typeof t)return`[BigInt: ${String(t)}]`;const r=function(e){const t=Object.getPrototypeOf(e);return t?.constructor?t.constructor.name:"null prototype"}(t);return/^HTML(\w*)Element$/.test(r)?`[HTMLElement: ${r}]`:`[object ${r}]`}catch(e){return`**non-serializable** (${e})`}var n}(e,t);if(!a.startsWith("[object "))return a;if(t.__sentry_skip_normalization__)return t;const c="number"==typeof t.__sentry_override_normalization_depth__?t.__sentry_override_normalization_depth__:n;if(0===c)return a.replace("object ","");if(s(t))return"[Circular ~]";const u=t;if(u&&"function"==typeof u.toJSON)try{return be("",u.toJSON(),c-1,r,i)}catch{}const l=Array.isArray(t)?[]:{};let d=0;const p=C(t);for(const e in p){if(!Object.prototype.hasOwnProperty.call(p,e))continue;if(d>=r){l[e]="[MaxProperties ~]";break}const t=p[e];l[e]=be(e,t,c-1,r,i),d++}return o(t),l}function ye(e,t=[]){return[e,t]}function _e(e,t){const[n,r]=e;return[n,[...r,t]]}function we(e,t){const n=e[1];for(const e of n)if(t(e,e[0].type))return!0;return!1}function Ee(e){const n=r(t);return n.encodePolyfill?n.encodePolyfill(e):(new TextEncoder).encode(e)}function Se(e){const[t,n]=e;let r=JSON.stringify(t);function i(e){"string"==typeof r?r="string"==typeof e?r+e:[Ee(r),e]:r.push("string"==typeof e?Ee(e):e)}for(const e of n){const[t,n]=e;if(i(`\n${JSON.stringify(t)}\n`),"string"==typeof n||n instanceof Uint8Array)i(n);else{let e;try{e=JSON.stringify(n)}catch{e=JSON.stringify(ve(n))}i(e)}}return"string"==typeof r?r:function(e){const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);let r=0;for(const t of e)n.set(t,r),r+=t.length;return n}(r)}function Ie(e){const t="string"==typeof e.data?Ee(e.data):e.data;return[{type:"attachment",length:t.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType},t]}const Oe={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security",log:"log_item"};function xe(e){return Oe[e]}function ke(e){if(!e?.sdk)return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}const Te=[];function Ce(e,t){for(const n of t)n?.afterAllSetup&&n.afterAllSetup(e)}function Ae(e,t,n){if(n[t.name])s&&x.log(`Integration skipped because it was already installed: ${t.name}`);else{if(n[t.name]=t,-1===Te.indexOf(t.name)&&"function"==typeof t.setupOnce&&(t.setupOnce(),Te.push(t.name)),t.setup&&"function"==typeof t.setup&&t.setup(e),"function"==typeof t.preprocessEvent){const n=t.preprocessEvent.bind(t);e.on("preprocessEvent",((t,r)=>n(t,r,e)))}if("function"==typeof t.processEvent){const n=t.processEvent.bind(t),r=Object.assign(((t,r)=>n(t,r,e)),{id:t.name});e.addEventProcessor(r)}s&&x.log(`Integration installed: ${t.name}`)}}const De="sentry.source",Pe="sentry.sample_rate",Re="sentry.previous_trace_sample_rate",Fe="sentry.op",Ne="sentry.origin",Le="sentry.profile_id",Me="sentry.exclusive_time",Ue="sentry-",ze=/^sentry-/;function $e(e){return e.split(",").map((e=>e.split("=").map((e=>{try{return decodeURIComponent(e.trim())}catch{return}})))).reduce(((e,[t,n])=>(t&&n&&(e[t]=n),e)),{})}const je=0,Be=1,Ve="_sentryScope",We="_sentryIsolationScope";function He(e){return{scope:e[Ve],isolationScope:e[We]}}const Ke=1;let Ge=!1;function Ye(e){const{spanId:t,traceId:n,isRemote:r}=e.spanContext(),i=r?t:Ze(e).parent_span_id,s=He(e).scope;return{parent_span_id:i,span_id:r?s?.getPropagationContext().propagationSpanId||V():t,trace_id:n}}function Je(e){return e&&e.length>0?e.map((({context:{spanId:e,traceId:t,traceFlags:n,...r},attributes:i})=>({span_id:e,trace_id:t,sampled:n===Ke,attributes:i,...r}))):void 0}function qe(e){return"number"==typeof e?Xe(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?Xe(e.getTime()):z()}function Xe(e){return e>9999999999?e/1e3:e}function Ze(e){if(function(e){return"function"==typeof e.getSpanJSON}(e))return e.getSpanJSON();const{spanId:t,traceId:n}=e.spanContext();if(function(e){const t=e;return!!(t.attributes&&t.startTime&&t.name&&t.endTime&&t.status)}(e)){const{attributes:r,startTime:i,name:s,endTime:o,status:a,links:c}=e;return{span_id:t,trace_id:n,data:r,description:s,parent_span_id:"parentSpanId"in e?e.parentSpanId:"parentSpanContext"in e?e.parentSpanContext?.spanId:void 0,start_timestamp:qe(i),timestamp:qe(o)||void 0,status:Qe(a),op:r[Fe],origin:r[Ne],links:Je(c)}}return{span_id:t,trace_id:n,start_timestamp:0,data:{}}}function Qe(e){if(e&&e.code!==je)return e.code===Be?"ok":e.message||"unknown_error"}const et="_sentryRootSpan";function tt(e){return e[et]||e}function nt(){Ge||(w((()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly.")})),Ge=!0)}const rt="_frozenDsc";function it(e,t){const n=t.getOptions(),{publicKey:r}=t.getDsn()||{},i={environment:n.environment||se,release:n.release,public_key:r,trace_id:e,org_id:le(t)};return t.emit("createDsc",i),i}function st(e){const t=ne();if(!t)return{};const n=tt(e),r=Ze(n),i=r.data,s=n.spanContext().traceState,o=s?.get("sentry.sample_rate")??i[Pe]??i[Re];function a(e){return"number"!=typeof o&&"string"!=typeof o||(e.sample_rate=`${o}`),e}const c=n[rt];if(c)return a(c);const u=s?.get("sentry.dsc"),l=u&&function(e){const t=function(e){if(e&&(d(e)||Array.isArray(e)))return Array.isArray(e)?e.reduce(((e,t)=>{const n=$e(t);return Object.entries(n).forEach((([t,n])=>{e[t]=n})),e}),{}):$e(e)}(e);if(!t)return;const n=Object.entries(t).reduce(((e,[t,n])=>(t.match(ze)&&(e[t.slice(Ue.length)]=n),e)),{});return Object.keys(n).length>0?n:void 0}(u);if(l)return a(l);const p=it(e.spanContext().traceId,t),f=i[De],h=r.description;return"url"!==f&&h&&(p.transaction=h),function(e){if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;const t=ne()?.getOptions();return!(!t||null==t.tracesSampleRate&&!t.tracesSampler)}()&&(p.sampled=String(function(e){const{traceFlags:t}=e.spanContext();return t===Ke}(n)),p.sample_rand=s?.get("sentry.sample_rand")??He(n).scope?.getPropagationContext().sampleRand.toString()),a(p),t.emit("createDsc",p,n),p}function ot(e){return new ct((t=>{t(e)}))}function at(e){return new ct(((t,n)=>{n(e)}))}class ct{constructor(e){this._state=0,this._handlers=[],this._runExecutor(e)}then(e,t){return new ct(((n,r)=>{this._handlers.push([!1,t=>{if(e)try{n(e(t))}catch(e){r(e)}else n(t)},e=>{if(t)try{n(t(e))}catch(e){r(e)}else r(e)}]),this._executeHandlers()}))}catch(e){return this.then((e=>e),e)}finally(e){return new ct(((t,n)=>{let r,i;return this.then((t=>{i=!1,r=t,e&&e()}),(t=>{i=!0,r=t,e&&e()})).then((()=>{i?n(r):t(r)}))}))}_executeHandlers(){if(0===this._state)return;const e=this._handlers.slice();this._handlers=[],e.forEach((e=>{e[0]||(1===this._state&&e[1](this._value),2===this._state&&e[2](this._value),e[0]=!0)}))}_runExecutor(e){const t=(e,t)=>{0===this._state&&(g(t)?t.then(n,r):(this._state=e,this._value=t,this._executeHandlers()))},n=e=>{t(1,e)},r=e=>{t(2,e)};try{e(n,r)}catch(e){r(e)}}}function ut(e,t,n,r=0){return new ct(((i,o)=>{const a=e[r];if(null===t||"function"!=typeof a)i(t);else{const c=a({...t},n);s&&a.id&&null===c&&x.log(`Event processor "${a.id}" dropped event`),g(c)?c.then((t=>ut(e,t,n,r+1).then(i))).then(null,o):ut(e,c,n,r+1).then(i).then(null,o)}}))}function lt(e,t){const{extra:n,tags:r,user:i,contexts:s,level:o,sdkProcessingMetadata:a,breadcrumbs:c,fingerprint:u,eventProcessors:l,attachments:d,propagationContext:p,transactionName:f,span:h}=t;dt(e,"extra",n),dt(e,"tags",r),dt(e,"user",i),dt(e,"contexts",s),e.sdkProcessingMetadata=j(e.sdkProcessingMetadata,a,2),o&&(e.level=o),f&&(e.transactionName=f),h&&(e.span=h),c.length&&(e.breadcrumbs=[...e.breadcrumbs,...c]),u.length&&(e.fingerprint=[...e.fingerprint,...u]),l.length&&(e.eventProcessors=[...e.eventProcessors,...l]),d.length&&(e.attachments=[...e.attachments,...d]),e.propagationContext={...e.propagationContext,...p}}function dt(e,t,n){e[t]=j(e[t],n,1)}let pt,ft,ht;function gt(e,n,r,s,o,a){const{normalizeDepth:c=3,normalizeMaxBreadth:u=1e3}=e,l={...n,event_id:n.event_id||r.event_id||P(),timestamp:n.timestamp||M()},d=r.integrations||e.integrations.map((e=>e.name));!function(e,t){const{environment:n,release:r,dist:i,maxValueLength:s=250}=t;e.environment=e.environment||n||se,!e.release&&r&&(e.release=r),!e.dist&&i&&(e.dist=i);const o=e.request;o?.url&&(o.url=k(o.url,s))}(l,e),function(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}(l,d),o&&o.emit("applyFrameMetadata",n),void 0===n.type&&function(e,n){const r=function(e){const n=t._sentryDebugIds;if(!n)return{};const r=Object.keys(n);return ht&&r.length===ft||(ft=r.length,ht=r.reduce(((t,r)=>{pt||(pt={});const i=pt[r];if(i)t[i[0]]=i[1];else{const i=e(r);for(let e=i.length-1;e>=0;e--){const s=i[e],o=s?.filename,a=n[r];if(o&&a){t[o]=a,pt[r]=[o,a];break}}}return t}),{})),ht}(n);e.exception?.values?.forEach((e=>{e.stacktrace?.frames?.forEach((e=>{e.filename&&(e.debug_id=r[e.filename])}))}))}(l,e.stackParser);const p=function(e,t){if(!t)return e;const n=e?e.clone():new G;return n.update(t),n}(s,r.captureContext);r.mechanism&&F(l,r.mechanism);const f=o?o.getEventProcessors():[],h=i("globalScope",(()=>new G)).getScopeData();a&&lt(h,a.getScopeData()),p&&lt(h,p.getScopeData());const g=[...r.attachments||[],...h.attachments];return g.length&&(r.attachments=g),function(e,t){const{fingerprint:n,span:r,breadcrumbs:i,sdkProcessingMetadata:s}=t;!function(e,t){const{extra:n,tags:r,user:i,contexts:s,level:o,transactionName:a}=t;Object.keys(n).length&&(e.extra={...n,...e.extra}),Object.keys(r).length&&(e.tags={...r,...e.tags}),Object.keys(i).length&&(e.user={...i,...e.user}),Object.keys(s).length&&(e.contexts={...s,...e.contexts}),o&&(e.level=o),a&&"transaction"!==e.type&&(e.transaction=a)}(e,t),r&&function(e,t){e.contexts={trace:Ye(t),...e.contexts},e.sdkProcessingMetadata={dynamicSamplingContext:st(t),...e.sdkProcessingMetadata};const n=Ze(tt(t)).description;n&&!e.transaction&&"transaction"===e.type&&(e.transaction=n)}(e,r),function(e,t){e.fingerprint=e.fingerprint?Array.isArray(e.fingerprint)?e.fingerprint:[e.fingerprint]:[],t&&(e.fingerprint=e.fingerprint.concat(t)),e.fingerprint.length||delete e.fingerprint}(e,n),function(e,t){const n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}(e,i),function(e,t){e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...t}}(e,s)}(l,h),ut([...f,...h.eventProcessors],l,r).then((e=>(e&&function(e){const t={};if(e.exception?.values?.forEach((e=>{e.stacktrace?.frames?.forEach((e=>{e.debug_id&&(e.abs_path?t[e.abs_path]=e.debug_id:e.filename&&(t[e.filename]=e.debug_id),delete e.debug_id)}))})),0===Object.keys(t).length)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const n=e.debug_meta.images;Object.entries(t).forEach((([e,t])=>{n.push({type:"sourcemap",code_file:e,debug_id:t})}))}(e),"number"==typeof c&&c>0?function(e,t,n){if(!e)return null;const r={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map((e=>({...e,...e.data&&{data:ve(e.data,t,n)}})))},...e.user&&{user:ve(e.user,t,n)},...e.contexts&&{contexts:ve(e.contexts,t,n)},...e.extra&&{extra:ve(e.extra,t,n)}};return e.contexts?.trace&&r.contexts&&(r.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(r.contexts.trace.data=ve(e.contexts.trace.data,t,n))),e.spans&&(r.spans=e.spans.map((e=>({...e,...e.data&&{data:ve(e.data,t,n)}})))),e.contexts?.flags&&r.contexts&&(r.contexts.flags=ve(e.contexts.flags,3,n)),r}(e,c,u):e)))}const vt="Not capturing exception because it's already been captured.",mt="Discarded session because of missing or non-string release",bt=Symbol.for("SentryInternalError"),yt=Symbol.for("SentryDoNotSendEventError");function _t(e){return{message:e,[bt]:!0}}function wt(e){return{message:e,[yt]:!0}}function Et(e){return!!e&&"object"==typeof e&&bt in e}function St(e){return!!e&&"object"==typeof e&&yt in e}class It{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=function(e){const t="string"==typeof e?function(e){const t=ae.exec(e);if(!t)return void w((()=>{console.error(`Invalid Sentry Dsn: ${e}`)}));const[n,r,i="",s="",o="",a=""]=t.slice(1);let c="",u=a;const l=u.split("/");if(l.length>1&&(c=l.slice(0,-1).join("/"),u=l.pop()),u){const e=u.match(/^\d+/);e&&(u=e[0])}return ue({host:s,pass:i,path:c,projectId:u,port:o,protocol:n,publicKey:r})}(e):ue(e);if(t&&function(e){if(!s)return!0;const{port:t,projectId:n,protocol:r}=e;return!(["protocol","publicKey","host","projectId"].find((t=>!e[t]&&(x.error(`Invalid Sentry Dsn: ${t} missing`),!0)))||(n.match(/^\d+$/)?function(e){return"http"===e||"https"===e}(r)?t&&isNaN(parseInt(t,10))&&(x.error(`Invalid Sentry Dsn: Invalid port ${t}`),1):(x.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),1):(x.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),1)))}(t))return t}(e.dsn):s&&x.warn("No DSN provided, client will not send events."),this._dsn){const i=(t=this._dsn,n=e.tunnel,r=e._metadata?e._metadata.sdk:void 0,n||`${function(e){return`${function(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}(e)}${e.projectId}/envelope/`}(t)}?${function(e,t){const n={sentry_version:"7"};return e.publicKey&&(n.sentry_key=e.publicKey),t&&(n.sentry_client=`${t.name}/${t.version}`),new URLSearchParams(n).toString()}(t,r)}`);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:i})}var t,n,r}captureException(e,t,n){const r=P();if(N(e))return s&&x.log(vt),r;const i={event_id:r,...t};return this._process(this.eventFromException(e,i).then((e=>this._captureEvent(e,i,n)))),i.event_id}captureMessage(e,t,n,r){const i={event_id:P(),...n},s=p(e)?e:String(e),o=null===(a=e)||p(a)||"object"!=typeof a&&"function"!=typeof a?this.eventFromMessage(s,t,i):this.eventFromException(e,i);var a;return this._process(o.then((e=>this._captureEvent(e,i,r)))),i.event_id}captureEvent(e,t,n){const r=P();if(t?.originalException&&N(t.originalException))return s&&x.log(vt),r;const i={event_id:r,...t},o=e.sdkProcessingMetadata||{},a=o.capturedSpanScope,c=o.capturedSpanIsolationScope;return this._process(this._captureEvent(e,i,a||n,c)),i.event_id}captureSession(e){this.sendSession(e),$(e,{init:!1})}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const t=this._transport;return t?(this.emit("flush"),this._isClientDoneProcessing(e).then((n=>t.flush(e).then((e=>n&&e))))):ot(!0)}close(e){return this.flush(e).then((e=>(this.getOptions().enabled=!1,this.emit("close"),e)))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some((({name:e})=>e.startsWith("Spotlight"))))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const t=this._integrations[e.name];Ae(this,e,this._integrations),t||Ce(this,[e])}sendEvent(e,t={}){this.emit("beforeSendEvent",e,t);let n=function(e,t,n,r){const i=ke(n),s=e.type&&"replay_event"!==e.type?e.type:"event";!function(e,t){t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]])}(e,n?.sdk);const o=function(e,t,n,r){const i=e.sdkProcessingMetadata?.dynamicSamplingContext;return{event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&{sdk:t},...!!n&&r&&{dsn:ce(r)},...i&&{trace:i}}}(e,i,r,t);return delete e.sdkProcessingMetadata,ye(o,[[{type:s},e]])}(e,this._dsn,this._options._metadata,this._options.tunnel);for(const e of t.attachments||[])n=_e(n,Ie(e));const r=this.sendEnvelope(n);r&&r.then((t=>this.emit("afterSendEvent",e,t)),null)}sendSession(e){const{release:t,environment:n=se}=this._options;if("aggregates"in e){const r=e.attrs||{};if(!r.release&&!t)return void(s&&x.warn(mt));r.release=r.release||t,r.environment=r.environment||n,e.attrs=r}else{if(!e.release&&!t)return void(s&&x.warn(mt));e.release=e.release||t,e.environment=e.environment||n}this.emit("beforeSendSession",e);const r=function(e,t,n,r){const i=ke(n);return ye({sent_at:(new Date).toISOString(),...i&&{sdk:i},...!!r&&t&&{dsn:ce(t)}},["aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(r)}recordDroppedEvent(e,t,n=1){if(this._options.sendClientReports){const r=`${e}:${t}`;s&&x.log(`Recording outcome: "${r}"${n>1?` (${n} times)`:""}`),this._outcomes[r]=(this._outcomes[r]||0)+n}}on(e,t){const n=this._hooks[e]=this._hooks[e]||[];return n.push(t),()=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)}}emit(e,...t){const n=this._hooks[e];n&&n.forEach((e=>e(...t)))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,(e=>(s&&x.error("Error while sending envelope:",e),e))):(s&&x.error("Transport disabled"),ot({}))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=function(e,t){const n={};return t.forEach((t=>{t&&Ae(e,t,n)})),n}(this,e),Ce(this,e)}_updateSessionFromEvent(e,t){let n="fatal"===t.level,r=!1;const i=t.exception?.values;if(i){r=!0;for(const e of i){const t=e.mechanism;if(!1===t?.handled){n=!0;break}}}const s="ok"===e.status;(s&&0===e.errors||s&&n)&&($(e,{...n&&{status:"crashed"},errors:e.errors||Number(r||n)}),this.captureSession(e))}_isClientDoneProcessing(e){return new ct((t=>{let n=0;const r=setInterval((()=>{0==this._numProcessing?(clearInterval(r),t(!0)):(n+=1,e&&n>=e&&(clearInterval(r),t(!1)))}),1)}))}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(e,t,n,r){const i=this.getOptions(),s=Object.keys(this._integrations);return!t.integrations&&s?.length&&(t.integrations=s),this.emit("preprocessEvent",e,t),e.type||r.setLastEventId(e.event_id||t.event_id),gt(i,e,t,n,this,r).then((e=>{if(null===e)return e;this.emit("postprocessEvent",e,t),e.contexts={trace:re(n),...e.contexts};const r=function(e,t){const n=t.getPropagationContext();return n.dsc||it(n.traceId,e)}(this,n);return e.sdkProcessingMetadata={dynamicSamplingContext:r,...e.sdkProcessingMetadata},e}))}_captureEvent(e,t={},n=ee(),r=te()){return s&&Ot(e)&&x.log(`Captured error event \`${function(e){const t=[];e.message&&t.push(e.message);try{const n=e.exception.values[e.exception.values.length-1];n?.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`))}catch{}return t}(e)[0]||"<unknown>"}\``),this._processEvent(e,t,n,r).then((e=>e.event_id),(e=>{s&&(St(e)?x.log(e.message):Et(e)?x.warn(e.message):x.warn(e))}))}_processEvent(e,t,n,r){const i=this.getOptions(),{sampleRate:s}=i,o=xt(e),a=Ot(e),c=e.type||"error",u=`before send for type \`${c}\``,l=void 0===s?void 0:function(e){if("boolean"==typeof e)return Number(e);const t="string"==typeof e?parseFloat(e):e;return"number"!=typeof t||isNaN(t)||t<0||t>1?void 0:t}(s);if(a&&"number"==typeof l&&Math.random()>l)return this.recordDroppedEvent("sample_rate","error"),at(wt(`Discarding event because it's not included in the random sample (sampling rate = ${s})`));const d="replay_event"===c?"replay":c;return this._prepareEvent(e,t,n,r).then((e=>{if(null===e)throw this.recordDroppedEvent("event_processor",d),wt("An event processor returned `null`, will not send event.");if(t.data&&!0===t.data.__sentry__)return e;const n=function(e,t,n,r){const{beforeSend:i,beforeSendTransaction:s,beforeSendSpan:o}=t;let a=n;if(Ot(a)&&i)return i(a,r);if(xt(a)){if(o){const e=o(function(e){const{trace_id:t,parent_span_id:n,span_id:r,status:i,origin:s,data:o,op:a}=e.contexts?.trace??{};return{data:o??{},description:e.transaction,op:a,parent_span_id:n,span_id:r??"",start_timestamp:e.start_timestamp??0,status:i,timestamp:e.timestamp,trace_id:t??"",origin:s,profile_id:o?.[Le],exclusive_time:o?.[Me],measurements:e.measurements,is_segment:!0}}(a));if(e?a=j(n,{type:"transaction",timestamp:(c=e).timestamp,start_timestamp:c.start_timestamp,transaction:c.description,contexts:{trace:{trace_id:c.trace_id,span_id:c.span_id,parent_span_id:c.parent_span_id,op:c.op,status:c.status,origin:c.origin,data:{...c.data,...c.profile_id&&{[Le]:c.profile_id},...c.exclusive_time&&{[Me]:c.exclusive_time}}}},measurements:c.measurements}):nt(),a.spans){const e=[];for(const t of a.spans){const n=o(t);n?e.push(n):(nt(),e.push(t))}a.spans=e}}if(s){if(a.spans){const e=a.spans.length;a.sdkProcessingMetadata={...n.sdkProcessingMetadata,spanCountBeforeProcessing:e}}return s(a,r)}}var c;return a}(0,i,e,t);return function(e,t){const n=`${t} must return \`null\` or a valid event.`;if(g(e))return e.then((e=>{if(!f(e)&&null!==e)throw _t(n);return e}),(e=>{throw _t(`${t} rejected with ${e}`)}));if(!f(e)&&null!==e)throw _t(n);return e}(n,u)})).then((i=>{if(null===i){if(this.recordDroppedEvent("before_send",d),o){const t=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",t)}throw wt(`${u} returned \`null\`, will not send event.`)}const s=n.getSession()||r.getSession();if(a&&s&&this._updateSessionFromEvent(s,i),o){const e=(i.sdkProcessingMetadata?.spanCountBeforeProcessing||0)-(i.spans?i.spans.length:0);e>0&&this.recordDroppedEvent("before_send","span",e)}const c=i.transaction_info;if(o&&c&&i.transaction!==e.transaction){const e="custom";i.transaction_info={...c,source:e}}return this.sendEvent(i,t),i})).then(null,(e=>{if(St(e)||Et(e))throw e;throw this.captureException(e,{data:{__sentry__:!0},originalException:e}),_t(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${e}`)}))}_process(e){this._numProcessing++,e.then((e=>(this._numProcessing--,e)),(e=>(this._numProcessing--,e)))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map((([e,t])=>{const[n,r]=e.split(":");return{reason:n,category:r,quantity:t}}))}_flushOutcomes(){s&&x.log("Flushing outcomes...");const e=this._clearOutcomes();if(0===e.length)return void(s&&x.log("No outcomes to send"));if(!this._dsn)return void(s&&x.log("No dsn provided, will not send outcomes"));s&&x.log("Sending outcomes:",e);const t=(n=e,ye((r=this._options.tunnel&&ce(this._dsn))?{dsn:r}:{},[[{type:"client_report"},{timestamp:M(),discarded_events:n}]]));var n,r;this.sendEnvelope(t)}}function Ot(e){return void 0===e.type}function xt(e){return"transaction"===e.type}function kt(e,t){const n=t??function(e){return Tt().get(e)}(e)??[];if(0===n.length)return;const r=e.getOptions(),i=function(e,t,n,r){const i={};return t?.sdk&&(i.sdk={name:t.sdk.name,version:t.sdk.version}),n&&r&&(i.dsn=ce(r)),ye(i,[(s=e,[{type:"log",item_count:s.length,content_type:"application/vnd.sentry.items.log+json"},{items:s}])]);var s}(n,r._metadata,r.tunnel,e.getDsn());Tt().set(e,[]),e.emit("flushLogs"),e.sendEnvelope(i)}function Tt(){return i("clientToLogBufferMap",(()=>new WeakMap))}function Ct(e){void 0===e.user?.ip_address&&(e.user={...e.user,ip_address:"{{auto}}"})}function At(e){"aggregates"in e?void 0===e.attrs?.ip_address&&(e.attrs={...e.attrs,ip_address:"{{auto}}"}):void 0===e.ipAddress&&(e.ipAddress="{{auto}}")}function Dt(e,t){const n=Rt(e,t),r={type:Lt(t),value:Mt(t)};return n.length&&(r.stacktrace={frames:n}),void 0===r.type&&""===r.value&&(r.value="Unrecoverable error caught"),r}function Pt(e,t){return{exception:{values:[Dt(e,t)]}}}function Rt(e,t){const n=t.stacktrace||t.stack||"",r=function(e){return e&&Ft.test(e.message)?1:0}(t),i=function(e){return"number"==typeof e.framesToPop?e.framesToPop:0}(t);try{return e(n,r,i)}catch{}return[]}const Ft=/Minified React error #\d+;/i;function Nt(e){return"undefined"!=typeof WebAssembly&&void 0!==WebAssembly.Exception&&e instanceof WebAssembly.Exception}function Lt(e){const t=e?.name;return!t&&Nt(e)?e.message&&Array.isArray(e.message)&&2==e.message.length?e.message[0]:"WebAssembly.Exception":t}function Mt(e){const t=e?.message;return Nt(e)?Array.isArray(e.message)&&2==e.message.length?e.message[1]:"wasm exception":t?t.error&&"string"==typeof t.error.message?t.error.message:t:"No error message"}function Ut(e,t,n,r){const i=function(e,t,n,r,i){let s;if(u(t)&&t.error)return Pt(e,t.error);if(l(t)||c(t,"DOMException")){const i=t;if("stack"in t)s=Pt(e,t);else{const t=i.name||(l(i)?"DOMError":"DOMException"),o=i.message?`${t}: ${i.message}`:t;s=zt(e,o,n,r),R(s,o)}return"code"in i&&(s.tags={...s.tags,"DOMException.code":`${i.code}`}),s}return a(t)?Pt(e,t):f(t)||h(t)?(s=function(e,t,n,r){const i=ne(),s=i?.getOptions().normalizeDepth,o=function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];if(n instanceof Error)return n}}(t),a={__serialized__:me(t,s)};if(o)return{exception:{values:[Dt(e,o)]},extra:a};const c={exception:{values:[{type:h(t)?t.constructor.name:r?"UnhandledRejection":"Error",value:$t(t,{isUnhandledRejection:r})}]},extra:a};if(n){const t=Rt(e,n);t.length&&(c.exception.values[0].stacktrace={frames:t})}return c}(e,t,n,void 0),F(s,{synthetic:!0}),s):(s=zt(e,t,n,r),R(s,`${t}`,void 0),F(s,{synthetic:!0}),s)}(e,t,n?.syntheticException||void 0,r);return F(i),i.level="error",n?.event_id&&(i.event_id=n.event_id),ot(i)}function zt(e,t,n,r){const i={};if(r&&n){const r=Rt(e,n);r.length&&(i.exception={values:[{value:t,stacktrace:{frames:r}}]}),F(i,{synthetic:!0})}if(p(t)){const{__sentry_template_string__:e,__sentry_template_values__:n}=t;return i.logentry={message:e,params:n},i}return i.message=t,i}function $t(e,{isUnhandledRejection:t}){const n=function(e,t=40){const n=Object.keys(C(e));n.sort();const r=n[0];if(!r)return"[object has no keys]";if(r.length>=t)return k(r,t);for(let e=n.length;e>0;e--){const r=n.slice(0,e).join(", ");if(!(r.length>t))return e===n.length?r:k(r,t)}return""}(e),r=t?"promise rejection":"exception";return u(e)?`Event \`ErrorEvent\` captured as ${r} with message \`${e.message}\``:h(e)?`Event \`${function(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{}}(e)}\` (type=${e.type}) captured as ${r}`:`Object captured as ${r} with keys: ${n}`}const jt=t,Bt=Symbol.for("SentryBufferFullError");const Vt=6e4;function Wt(e,t,n=function(e){const t=[];function n(e){return t.splice(t.indexOf(e),1)[0]||Promise.resolve(void 0)}return{$:t,add:function(r){if(!(void 0===e||t.length<e))return at(Bt);const i=r();return-1===t.indexOf(i)&&t.push(i),i.then((()=>n(i))).then(null,(()=>n(i).then(null,(()=>{})))),i},drain:function(e){return new ct(((n,r)=>{let i=t.length;if(!i)return n(!0);const s=setTimeout((()=>{e&&e>0&&n(!1)}),e);t.forEach((e=>{ot(e).then((()=>{--i||(clearTimeout(s),n(!0))}),r)}))}))}}}(e.bufferSize||64)){let r={};return{send:function(i){const o=[];if(we(i,((t,n)=>{const i=xe(n);!function(e,t,n=Date.now()){return function(e,t){return e[t]||e.all||0}(e,t)>n}(r,i)?o.push(t):e.recordDroppedEvent("ratelimit_backoff",i)})),0===o.length)return ot({});const a=ye(i[0],o),c=t=>{we(a,((n,r)=>{e.recordDroppedEvent(t,xe(r))}))};return n.add((()=>t({body:Se(a)}).then((e=>(void 0!==e.statusCode&&(e.statusCode<200||e.statusCode>=300)&&s&&x.warn(`Sentry responded with status code ${e.statusCode} to sent event.`),r=function(e,{statusCode:t,headers:n},r=Date.now()){const i={...e},s=n?.["x-sentry-rate-limits"],o=n?.["retry-after"];if(s)for(const e of s.trim().split(",")){const[t,n,,,s]=e.split(":",5),o=parseInt(t,10),a=1e3*(isNaN(o)?60:o);if(n)for(const e of n.split(";"))"metric_bucket"===e&&s&&!s.split(";").includes("custom")||(i[e]=r+a);else i.all=r+a}else o?i.all=r+function(e,t=Date.now()){const n=parseInt(`${e}`,10);if(!isNaN(n))return 1e3*n;const r=Date.parse(`${e}`);return isNaN(r)?Vt:r-t}(o,r):429===t&&(i.all=r+6e4);return i}(r,e),e)),(e=>{throw c("network_error"),s&&x.error("Encountered error running transport request:",e),e})))).then((e=>e),(e=>{if(e===Bt)return s&&x.error("Skipped sending event because buffer is full."),c("queue_overflow"),ot({});throw e}))},flush:e=>n.drain(e)}}const Ht="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,Kt=t,Gt={};function Yt(e){Gt[e]=void 0}function Jt(e,t,n,r){const i={filename:e,function:"<anonymous>"===t?de:t,in_app:!0};return void 0!==n&&(i.lineno=n),void 0!==r&&(i.colno=r),i}const qt=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,Xt=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Zt=/\((\S*)(?::(\d+))(?::(\d+))\)/,Qt=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,en=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,tn=function(...e){const t=e.sort(((e,t)=>e[0]-t[0])).map((e=>e[1]));return(e,n=0,r=0)=>{const i=[],s=e.split("\n");for(let e=n;e<s.length;e++){let n=s[e];n.length>1024&&(n=n.slice(0,1024));const o=pe.test(n)?n.replace(pe,"$1"):n;if(!o.match(/\S*Error: /)){for(const e of t){const t=e(o);if(t){i.push(t);break}}if(i.length>=50+r)break}}return function(e){if(!e.length)return[];const t=Array.from(e);return/sentryWrapped/.test(he(t).function||"")&&t.pop(),t.reverse(),fe.test(he(t).function||"")&&(t.pop(),fe.test(he(t).function||"")&&t.pop()),t.slice(0,50).map((e=>({...e,filename:e.filename||he(t).filename,function:e.function||de})))}(i.slice(r))}}([30,e=>{const t=qt.exec(e);if(t){const[,e,n,r]=t;return Jt(e,de,+n,+r)}const n=Xt.exec(e);if(n){if(n[2]&&0===n[2].indexOf("eval")){const e=Zt.exec(n[2]);e&&(n[2]=e[1],n[3]=e[2],n[4]=e[3])}const[e,t]=nn(n[1]||de,n[2]);return Jt(t,e,n[3]?+n[3]:void 0,n[4]?+n[4]:void 0)}}],[50,e=>{const t=Qt.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const e=en.exec(t[3]);e&&(t[1]=t[1]||"eval",t[3]=e[1],t[4]=e[2],t[5]="")}let e=t[3],n=t[1]||de;return[n,e]=nn(n,e),Jt(e,n,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}}]),nn=(e,t)=>{const n=-1!==e.indexOf("safari-extension"),r=-1!==e.indexOf("safari-web-extension");return n||r?[-1!==e.indexOf("@")?e.split("@")[0]:de,n?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]};var rn,sn=/bot|crawl|http|lighthouse|scan|search|spider/i;var on,an,cn,un,ln,dn,pn,fn,hn=(on=function(e,t){return on=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},on(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}on(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),gn=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},vn=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},mn=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};!function(e){e.PHONE="PHONE",e.TABLET="TABLET",e.DESKTOP="DESKTOP"}(an||(an={})),function(e){e.MAC_OS="MAC_OS",e.IOS="IOS",e.WINDOWS="WINDOWS",e.ANDROID="ANDROID",e.LINUX="LINUX"}(cn||(cn={})),function(e){e.OPERA="OPERA",e.FIREFOX="FIREFOX",e.SAFARI="SAFARI",e.IE="IE",e.EDGE="EDGE",e.CHROME="CHROME"}(un||(un={})),function(e){e.AB="AB",e.SPLIT="SPLIT",e.PERSONALIZATION="PERSONALIZATION"}(ln||(ln={})),function(e){e.LEGACY_CLICK_SUBMIT="LEGACY_CLICK_SUBMIT",e.CLICK="CLICK",e.SUBMIT="SUBMIT",e.PAGE_VIEW="PAGE_VIEW",e.SCROLL_DEPTH="SCROLL_DEPTH",e.TIME_ON_PAGE="TIME_ON_PAGE",e.PROGRAMMATIC="PROGRAMMATIC"}(dn||(dn={})),function(e){e.PIXELS="PIXELS",e.PERCENTAGE="PERCENTAGE"}(pn||(pn={})),function(e){e.EXACT="EXACT",e.STARTS_WITH="STARTS_WITH",e.CONTAINS="CONTAINS",e.ENDS_WITH="ENDS_WITH"}(fn||(fn={})),ie("url",window.location.href);var bn=new class extends It{constructor(t){const n=(r=t,{release:"string"==typeof __SENTRY_RELEASE__?__SENTRY_RELEASE__:jt.SENTRY_RELEASE?.id,sendClientReports:!0,parentSpanIsAlwaysRootSpan:!0,...r});var r;!function(t,n,r=[n],i="npm"){const s=t._metadata||{};s.sdk||(s.sdk={name:`sentry.javascript.${n}`,packages:r.map((t=>({name:`${i}:@sentry/${t}`,version:e}))),version:e}),t._metadata=s}(n,"browser",["browser"],jt.SENTRY_SDK_SOURCE||"npm"),super(n);const{sendDefaultPii:i,sendClientReports:s,enableLogs:o}=this._options;jt.document&&(s||o)&&jt.document.addEventListener("visibilitychange",(()=>{"hidden"===jt.document.visibilityState&&(s&&this._flushOutcomes(),o&&kt(this))})),o&&(this.on("flush",(()=>{kt(this)})),this.on("afterCaptureLog",(()=>{this._logFlushIdleTimeout&&clearTimeout(this._logFlushIdleTimeout),this._logFlushIdleTimeout=setTimeout((()=>{kt(this)}),5e3)}))),i&&(this.on("postprocessEvent",Ct),this.on("beforeSendSession",At))}eventFromException(e,t){return Ut(this._options.stackParser,e,t,this._options.attachStacktrace)}eventFromMessage(e,t="info",n){return function(e,t,n="info",r,i){const s=zt(e,t,r?.syntheticException||void 0,i);return s.level=n,r?.event_id&&(s.event_id=r.event_id),ot(s)}(this._options.stackParser,e,t,n,this._options.attachStacktrace)}_prepareEvent(e,t,n,r){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,n,r)}}({dsn:"https://3266931c85fced597df7d2c3891c380a@o4506872303845376.ingest.us.sentry.io/4506882884370432",transport:function(e,t=function(e){const t=Gt[e];if(t)return t;let n=Kt[e];if((r=n)&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(r.toString()))return Gt[e]=n.bind(Kt);var r;const i=Kt.document;if(i&&"function"==typeof i.createElement)try{const t=i.createElement("iframe");t.hidden=!0,i.head.appendChild(t);const r=t.contentWindow;r?.[e]&&(n=r[e]),i.head.removeChild(t)}catch(t){Ht&&x.warn(`Could not create sandbox iframe for ${e} check, bailing to window.${e}: `,t)}return n?Gt[e]=n.bind(Kt):n}("fetch")){let n=0,r=0;return Wt(e,(function(i){const s=i.body.length;n+=s,r++;const o={body:i.body,method:"POST",referrerPolicy:"strict-origin",headers:e.headers,keepalive:n<=6e4&&r<15,...e.fetchOptions};if(!t)return Yt("fetch"),at("No fetch implementation available");try{return t(e.url,o).then((e=>(n-=s,r--,{statusCode:e.status,headers:{"x-sentry-rate-limits":e.headers.get("X-Sentry-Rate-Limits"),"retry-after":e.headers.get("Retry-After")}})))}catch(e){return Yt("fetch"),n-=s,r--,at(e)}}))},stackParser:tn,integrations:[],environment:"production"}),yn=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return hn(t,e),t}(Error);try{!function(){var e=this;if(window.optibaseScriptLoaded)throw new yn("[Optibase] Detected duplicated Optibase Script.");function t(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];U&&console.log.apply(console,mn(["[Optibase ".concat(e,"]:")],t,!1))}function n(){var e,t;return(null===(e=window.optibaseSubscriptionPlan)||void 0===e?void 0:e.includes("PROFESSIONAL"))||(null===(t=window.optibaseSubscriptionPlan)||void 0===t?void 0:t.includes("CUSTOM"))}function r(){var e,t;return(null===(e=window.optibaseSubscriptionPlan)||void 0===e?void 0:e.includes("PROFESSIONAL"))||(null===(t=window.optibaseSubscriptionPlan)||void 0===t?void 0:t.includes("CUSTOM"))}function i(e){var t;return null!==(t=null==e?void 0:e.some((function(e){return e.test.recordingsEnabled&&e.eligible})))&&void 0!==t&&t}function s(){var e=window.navigator.userAgent.toLowerCase(),n=e.indexOf("edge")>-1||e.indexOf("edg")>-1?un.EDGE:e.indexOf("opr")>-1&&window.opr?un.OPERA:e.indexOf("chrome")>-1&&window.chrome?un.CHROME:e.indexOf("trident")>-1?un.IE:e.indexOf("firefox")>-1?un.FIREFOX:e.indexOf("safari")>-1?un.SAFARI:void 0;return t("metadata","Current Browser: ".concat(n,".")),n}function o(){var e=window.navigator.userAgent,n=window.navigator.platform,r=void 0;return/Macintosh|MacIntel|MacPPC|Mac68K|Darwin/.test(n)?r=cn.MAC_OS:/iPhone|iPad|iPod/.test(n)?r=cn.IOS:/Win32|Win64|Windows|WinCE/.test(n)?r=cn.WINDOWS:/Android/.test(e)?r=cn.ANDROID:/Linux/.test(n)&&(r=cn.LINUX),t("metadata","Current OS: ".concat(r,".")),r}function a(){var e=window.innerWidth<=767?an.PHONE:window.innerWidth<=990?an.TABLET:an.DESKTOP;return t("metadata","Current Screen Size: ".concat(e,".")),e}function c(){var e=null===navigator||void 0===navigator?void 0:navigator.language;if(e)return t("metadata","Browser Language: ".concat(e)),e}function u(e){try{var t=new URL(e.startsWith("http")?e:"https://".concat(e));return t.origin+t.pathname}catch(e){return null}}var l=document.createElement("style");function d(){var e;t("showBody","Showing body."),null===(e=l.parentNode)||void 0===e||e.removeChild(l)}function p(e,n){return gn(this,void 0,void 0,(function(){var r,i,s,o,a,u,l,d,p,f,h;return vn(this,(function(g){switch(g.label){case 0:return t("getInitialize","Fetching active for publicApiKey: ".concat(W,".")),[4,fetch(H+"/api/script/active?publicApiKey=".concat(W,"&hostname=").concat(window.location.hostname))];case 1:if(!(r=g.sent()).ok)throw new yn("[Optibase] Error occurred while fetching active.");return[4,r.json()];case 2:return t("getInitialize","Active response:",i=g.sent()),i.active?(window.optibaseSubscriptionPlan=i.subscriptionPlan,ue=i.consentMode||"default",le=i.consentBannerConfig||null,t("getInitialize","Consent mode: ".concat(ue)),s=Boolean(ee),I=null==N?void 0:N.getItem("optibaseConsent:".concat(W)),pe=!1===(o="true"===I||"false"!==I&&null),s&&!pe?(de=!0,t("getInitialize","Returning user with testedUserId, tracking enabled")):!0===o?(de=!0,t("getInitialize","User previously consented, tracking enabled")):"default"===ue&&(de=!0,t("getInitialize","Default consent mode, tracking enabled")),pe&&t("getInitialize","User previously declined consent"),a=de,_=(y=new URLSearchParams(window.location.search)).get("utm_source")||void 0,w=y.get("utm_campaign")||void 0,E=y.get("utm_content")||void 0,S=y.get("utm_medium")||void 0,t("metadata","UTM Params: source=".concat(_,", campaign=").concat(w,", content=").concat(E,", medium=").concat(S)),u={utmSource:_,utmCampaign:w,utmContent:E,utmMedium:S},m=(v=new Date).getHours()<12?"AM":"PM",b=["SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"][v.getDay()],t("metadata","Client time: timeOfDay=".concat(m,", dayOfWeek=").concat(b)),t("getInitialize","Calling with body:",d={publicApiKey:W,testedUserId:ee,entryUrl:X,screenSize:J,browser:G,OS:Y,topReferrer:q,testsOnPage:e,conversionsOnPage:n,utmSource:u.utmSource,utmCampaign:u.utmCampaign,utmContent:u.utmContent,utmMedium:u.utmMedium,timeOfDay:(l={timeOfDay:m,dayOfWeek:b}).timeOfDay,dayOfWeek:l.dayOfWeek,browserLanguage:c(),tracking:a}),[4,fetch(H+"/api/script/initialize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d),credentials:"include"}).catch((function(){}))]):[2,{userNotLoggedIn7Days:!0,randomSeed:Math.floor(1e9*Math.random())}];case 3:if(!(p=g.sent()))throw new yn("[Optibase] Error occurred while fetching initialize.");return p.ok?[3,6]:[4,p.json().catch((function(){}))];case 4:return f=g.sent(),[4,p.text().catch((function(){}))];case 5:throw g.sent(),400!==p.status||f.clientError?500===p.status?new yn("[Optibase] Response not ok when calling getInitialize: "+(null==f?void 0:f.message)||0):new Error("[Optibase] Response not ok when calling getInitialize: "+(null==f?void 0:f.message)||0):new yn("[Optibase] Response not ok when calling getInitialize: "+(null==f?void 0:f.message)||0);case 6:return[4,p.json()];case 7:return t("getInitialize","Response:",h=g.sent()),[2,h]}var v,m,b,y,_,w,E,S,I}))}))}var f=0;function h(){var e=Math.pow(2,32);return(f=(1664525*f+1013904223)%e)/e}function g(e){var t=e.standaloneHeatmaps||[];if(!t.length)return window.optibaseManualHeatmapUrls=[],[];var n=t.filter((function(e){try{return u(e.url)===Z}catch(e){return!1}}));return window.optibaseManualHeatmapUrls=n.map((function(e){return e.url})),n}function v(e){var t=e.standaloneRecordings||[];if(!t.length)return window.optibaseManualRecordingUrls=[],[];var n=t.filter((function(e){try{return u(e.url)===Z}catch(e){return!1}}));return window.optibaseManualRecordingUrls=n.map((function(e){return e.url})),n}function m(e,s,o){return gn(this,void 0,void 0,(function(){var a,c,u,l,p,h,m,_,w,O,k,T,F,L,U,z,V;return vn(this,(function(K){switch(K.label){case 0:if(e.monthlyTestedUsersLimitReached&&(window.monthlyTestedUsersLimitReached=!0,console.error("[Optibase] The Monthly Tested Users limit has been reached.")),e.noTestsOrConversionsOnPage&&(window.noTestsOrConversionsOnPage=!0,t("handleInitializeResponse","No tests or conversions found on the page.")),e.userNotLoggedIn7Days&&(window.userNotLoggedIn7Days=!0,console.error("handleInitializeResponse","The user has not logged in in the last 7 days, please log in again to start running tests. It might take up to 2h after logging in for the script to be active again.")),!e.randomSeed)throw new Error("[Optibase] Random seed not returned.");return a="optibaseCachedInitializeResponse-tests".concat(s,"-conversions").concat(o),null==N||N.setItem(a,JSON.stringify(e)),f=e.randomSeed,e.testedUserId&&(ee=e.testedUserId,window.optibaseTestedUserId=ee,null===(m=window.localStorage)||void 0===m||m.setItem("optibaseTestedUserId",e.testedUserId)),e.testedUserExternalId&&(te=e.testedUserExternalId,window.optibaseTestedUserExternalId=e.testedUserExternalId,null===(_=window.localStorage)||void 0===_||_.setItem("optibaseTestedUserExternalId",e.testedUserExternalId)),c=g(e),u=v(e),E((null===(w=e.tests)||void 0===w?void 0:w.filter((function(e){return e.eligible&&e.test.type===ln.SPLIT})))||[],!1,j,B)?[2]:(S((null===(O=e.tests)||void 0===O?void 0:O.filter((function(e){return e.test.type===ln.AB})))||[],!1,j,B),I(e.personalizations||[],!1,j,B),window.optibaseInitialized=!0,d(),l=(new Date).getTime()-M.getTime(),fe=mn([],ne,!0),he=e.conversions||[],p=(null===(k=e.tests)||void 0===k?void 0:k.some((function(e){return e.test.heatmapsEnabled&&e.eligible})))||(null===(T=e.personalizations)||void 0===T?void 0:T.some((function(e){return e.test.heatmapsEnabled&&e.eligible}))),ge=Boolean((p||c.length>0)&&n()),h=i(e.tests)||i(e.personalizations),ve=Boolean((h||u.length>0)&&r()),$?[3,3]:de?(C((null===(F=e.conversions)||void 0===F?void 0:F.filter((function(e){return e.type===dn.CLICK||e.type===dn.LEGACY_CLICK_SUBMIT})))||[]),A((null===(L=e.conversions)||void 0===L?void 0:L.filter((function(e){return e.type===dn.SUBMIT||e.type===dn.LEGACY_CLICK_SUBMIT})))||[]),P((null===(U=e.conversions)||void 0===U?void 0:U.filter((function(e){return e.type===dn.SCROLL_DEPTH})))||[]),R((null===(z=e.conversions)||void 0===z?void 0:z.filter((function(e){return e.type===dn.TIME_ON_PAGE})))||[]),[4,x(l)]):[3,2]);case 1:return K.sent(),D((null===(V=e.conversions)||void 0===V?void 0:V.filter((function(e){return e.type===dn.PAGE_VIEW})))||[]),ge&&b(H,W),ve&&y(H,W),[3,3];case 2:"optibase"!==ue||pe?"optibase"===ue&&pe?t("handleInitializeResponse","User previously declined consent, not showing banner"):"external"===ue&&t("handleInitializeResponse","External consent mode - waiting for optibaseEnableTracking()"):(t("handleInitializeResponse","Showing consent banner (optibase mode)"),function(){var e=this;t("showConsentBanner","Displaying consent banner");var n=le||{title:"Cookie Consent",description:"This website collects interaction data to run experiments and improve your experience using Optibase. Your activity may be tracked and analyzed while you're on this page. No personal information is sold or shared with third parties.",acceptText:"Accept",declineText:"Deny"},r=document.createElement("div");r.id="optibase-consent-banner",r.innerHTML='\n      <div style="position:fixed;bottom:1rem;left:1rem;width:20rem;background:#fff;\n        border:1px solid #e5e7eb;border-radius:0.5rem;padding:1.5rem;\n        z-index:999999;font-family:system-ui,-apple-system,sans-serif;\n        box-shadow:0 10px 15px -3px rgba(0,0,0,0.1),0 4px 6px -2px rgba(0,0,0,0.05)">\n        <h3 style="margin:0;font-size:1.125rem;font-weight:600;color:#111827;line-height:1.75rem">'.concat(n.title,'</h3>\n        <p style="margin:0.5rem 0 0 0;font-size:0.875rem;color:#4b5563;line-height:1.25rem">').concat(n.description).concat(n.linkText&&n.linkUrl?' <a href="'.concat(n.linkUrl,'" target="_blank" rel="noopener noreferrer" style="color:inherit;text-decoration:underline">').concat(n.linkText,"</a>"):"",'</p>\n        <div style="margin-top:1rem;display:flex;gap:0.75rem">\n          <button id="optibase-decline" style="border-radius:0.375rem;border:1px solid #d1d5db;\n            background:#fff;padding:0.5rem 1rem;font-size:0.875rem;font-weight:500;\n            color:#374151;cursor:pointer">').concat(n.declineText,'</button>\n          <button id="optibase-accept" style="border-radius:0.375rem;border:none;\n            background:#111827;padding:0.5rem 1rem;font-size:0.875rem;font-weight:500;\n            color:#fff;cursor:pointer">').concat(n.acceptText,"</button>\n        </div>\n      </div>"),document.body.appendChild(r);var i=document.getElementById("optibase-decline"),s=document.getElementById("optibase-accept");null==i||i.addEventListener("mouseenter",(function(){i.style.background="#f9fafb"})),null==i||i.addEventListener("mouseleave",(function(){i.style.background="#fff"})),null==s||s.addEventListener("mouseenter",(function(){s.style.background="#1f2937"})),null==s||s.addEventListener("mouseleave",(function(){s.style.background="#111827"})),null==s||s.addEventListener("click",(function(){return gn(e,void 0,void 0,(function(){return vn(this,(function(e){switch(e.label){case 0:return r.remove(),me(!0),[4,be()];case 1:return e.sent(),[2]}}))}))})),null==i||i.addEventListener("click",(function(){r.remove(),me(!1),t("showConsentBanner","User declined consent")}))}()),K.label=3;case 3:return t("handleInitializeResponse","Finished setting up Optibase. Time to setup: ".concat(l,"ms.")),[2]}}))}))}function b(e,n){if(t("loadHeatmapScript","Loading heatmap tracking script"),document.querySelector("script[data-optibase-heatmap]"))t("loadHeatmapScript","Heatmap script already loaded");else{var r=document.createElement("script");r.setAttribute("data-optibase-heatmap","true"),r.setAttribute("public-api-key",n),r.src="".concat(e,"/script-heatmap.js"),r.async=!0,r.onerror=function(){console.error("[Optibase] Failed to load heatmap script")},document.head.appendChild(r),t("loadHeatmapScript","Heatmap script loaded")}}function y(e,n){if(t("loadRecordingScript","Loading recording tracking script"),document.querySelector("script[data-optibase-recording]"))t("loadRecordingScript","Recording script already loaded");else{var r=document.createElement("script");r.setAttribute("data-optibase-recording","true"),r.setAttribute("public-api-key",n),r.src="".concat(e,"/script-recording.js"),r.async=!0,r.onerror=function(){console.error("[Optibase] Failed to load recording script")},document.head.appendChild(r),t("loadRecordingScript","Recording script loaded")}}function _(e,t,n){if(!e)return!1;var r=t?Q:Z;switch(n){case fn.EXACT:return r===e;case fn.STARTS_WITH:return r.startsWith(e);case fn.CONTAINS:return r.includes(e);case fn.ENDS_WITH:return r.endsWith(e)}}function w(e,t){for(var n=e.reduce((function(e,t){return e+(t.trafficSplitWeight||0)}),0),r=t*n,i=0,s=e;i<s.length;i++){var o=s[i];if((r-=o.trafficSplitWeight||0)<=0)return o}return e[e.length-1]}function E(e,n,r,i){var s=n?"handleSplitTests cached":"handleSplitTests";t(s,"Handling Split Tests splitTests:",e,"fromCached",n);for(var o=null,a=!1,c=!1,u=null,l=function(e){t(s,"Checking split test:",e);var l=e.test.variants.find((function(e){return e.main})),d=l.url,p=l.sameOrigin,f=h();if(t(s,"Checking if URL matches the current origin. entryUrl: ".concat(d,", sameOrigin: ").concat(p,".")),_(d,p,fn.EXACT))if(t(s,"URL matches the current origin. Checking for a variant to run."),u=e,(null==r?void 0:r.userFriendlyTestId)===e.test.userFriendlyId){var g=e.test.variants.findIndex((function(e){return e.userFriendlyId===(null==r?void 0:r.userFriendlyVariantId)}));-1!==g&&(o=e.test.variants[g],a=!0,c=!0,t(s,"Selected preview variant:",o))}else if(i.length){var v=e.test.variants.findIndex((function(e){return i.find((function(t){return t.userFriendlyVariantId===e.userFriendlyId&&t.userFriendlyTestId===(null==u?void 0:u.test.userFriendlyId)}))}));-1!==v&&(o=e.test.variants[v],a=!0,t(s,"Selected forced variant:",o))}else{if($)return c=!0,t(s,"Skipping handling Split Tests because script is disabled."),{value:!1};if(e.test.winnerVariantFriendlyId){var m=e.test.variants.find((function(t){return t.userFriendlyId===e.test.winnerVariantFriendlyId}));if(!m)return console.error('[Optibase] Error: Winner Variant with ID "'.concat(e.test.winnerVariantFriendlyId,'" does not exist.')),{value:!1};c=!0,t(s,"Selected winner variant:",m),o=m,a=!0}else o=w(e.test.variants,f),t(s,"Selected random variant:",o)}if(!n&&!r&&!c){var b=e.test.variants.find((function(e){return _(e.url,e.sameOrigin,fn.EXACT)}));b&&(t(s,"Found a split test variant for the current page."),ne.push({userFriendlyTestId:e.test.userFriendlyId,userFriendlyVariantId:b.userFriendlyId,heatmapsEnabled:e.test.heatmapsEnabled,recordingsEnabled:e.test.recordingsEnabled}))}},d=0,p=e;d<p.length;d++){var f=l(p[d]);if("object"==typeof f)return f.value}if(u&&o){t(s,"Found split test to run:",u);var g=u.test.variants.find((function(e){return e.shownBefore})),v=a?o:g||o;if(t(s,"Selected variant:",v),v.main)return t(s,"Not redirecting because selected variant is the current page."),!1;if(!r||a){if(!n){t(s,"Redirecting to ".concat(v.url,"."));var m=decodeURIComponent(v.url);window.location.href=m+window.location.search}return!0}return!0}return t(s,"Found no split test to run."),!1}function S(e,n,r,i){var s=n?"handleABTests cached":"handleABTests";t(s,"Handling A/B Tests abTests:",e," fromCached:",n);var o=document.querySelectorAll("[data-optibase-test-id]");if(0!==o.length){var a=new Map;o.forEach((function(t){var r=t.getAttribute("data-optibase-test-id"),i=t.getAttribute("data-optibase-variant-id");if(r)if(i){if(!t.getAttribute("data-optibase-personalization-id")){var s=null==e?void 0:e.find((function(e){return e.test.userFriendlyId===r}));s?s.test.variants.find((function(e){return e.userFriendlyId===i}))?(a.has(r)||a.set(r,[]),a.get(r).push(t)):n&&console.error("[Optibase] Error: Element on the site is not part of any test. Invalid Variant ID: ".concat(i)):n||console.error("[Optibase] Error: Element on the site is not part of any test. Invalid Test ID: ".concat(r))}}else console.error("[Optibase] Error: Element on the site missing 'data-optibase-variant-id' attribute. Test ID: ".concat(r))})),t(s,"Found elements for A/B Tests:",a),a.forEach((function(o,a){var c=null==e?void 0:e.find((function(e){return e.test.userFriendlyId===a}));t(s,"Handling A/B test with userFriendlyId: ".concat(a,".")),c&&!c.eligible&&t(s,"Test is not eligable bacause: ".concat(c.reason));var u=[],l=null==c?void 0:c.test.variants.find((function(e){return e.main})),d=o.filter((function(e){return(null==l?void 0:l.userFriendlyId)&&e.getAttribute("data-optibase-variant-id")===l.userFriendlyId})),p=o.filter((function(e){return i.some((function(t){return e.getAttribute("data-optibase-variant-id")===t.userFriendlyVariantId&&a===t.userFriendlyTestId}))})),f=o.filter((function(e){return(null==r?void 0:r.userFriendlyVariantId)&&e.getAttribute("data-optibase-variant-id")===r.userFriendlyVariantId&&(null==c?void 0:c.test.userFriendlyId)===(null==r?void 0:r.userFriendlyTestId)})),g=o.filter((function(e){return(null==c?void 0:c.test.winnerVariantFriendlyId)&&e.getAttribute("data-optibase-variant-id")===c.test.winnerVariantFriendlyId})),v=!1;if(f.length)t(s,"Selecting the preview variant."),v=!0,u=f;else if(p.length)t(s,"Selecting the forced variant."),u=p;else if($&&d.length)t(s,"Selecting the main variant by default because the script is disabled."),v=!0,u=d;else if(g.length)t(s,"Selecting the winner variant."),v=!0,u=g;else if(!(null==c?void 0:c.eligible)&&d.length)t(s,"Selecting the main variant because test is not eligible."),v=!0,u=d;else{var m=null==c?void 0:c.test.variants.find((function(e){return e.shownBefore})),b=o.filter((function(e){return e.getAttribute("data-optibase-variant-id")===(null==m?void 0:m.userFriendlyId)}));if(b.length)u=b;else{var y=h(),_=Array.from(new Set(o.map((function(e){return e.getAttribute("data-optibase-variant-id")})))),E=_.map((function(e){var t=null==c?void 0:c.test.variants.find((function(t){return t.userFriendlyId===e}));return{userFriendlyVariantId:e,trafficSplitWeight:(null==t?void 0:t.trafficSplitWeight)||0}}));t(s,"Selecting random variant from ".concat(_.length," unique variants:"),E);var S=w(E,y).userFriendlyVariantId;t(s,"Selected random variant:",S),u=o.filter((function(e){return e.getAttribute("data-optibase-variant-id")===S}))}}var I=u[0].getAttribute("data-optibase-variant-id");t(s,"Selected variant with userFriendlyVariantId: ".concat(I,". Elements:"),u),r||$||!(null==c?void 0:c.eligible)||v||n||ne.push({userFriendlyTestId:a,userFriendlyVariantId:I,heatmapsEnabled:null==c?void 0:c.test.heatmapsEnabled,recordingsEnabled:null==c?void 0:c.test.recordingsEnabled});for(var O=0,x=u;O<x.length;O++){var k=x[O];"none"===k.style.display&&(k.style.display="")}for(var T=0,C=o;T<C.length;T++){var A=C[T];A.getAttribute("data-optibase-variant-id")!==I&&(n?A.style.display="none":A.remove())}}))}else t(s,"No elements with A/B testing attributes found.")}function I(e,n,r,i){var s=n?"handlePersonalizations cached":"handlePersonalizations";t(s,"Handling Personalizations personalizations:",e," fromCached:",n);var o=document.querySelectorAll("[data-optibase-personalization-id]");if(0!==o.length){var a=new Map;o.forEach((function(t){var r=t.getAttribute("data-optibase-personalization-id"),i=t.getAttribute("data-optibase-variant-id");if(r)if(i){var s=null==e?void 0:e.find((function(e){return e.test.userFriendlyId===r}));s?s.test.variants.find((function(e){return e.userFriendlyId===i}))?(a.has(r)||a.set(r,[]),a.get(r).push(t)):n&&console.error("[Optibase] Error: Element on the site is not part of any personalization. Invalid Variant ID: ".concat(i)):n||console.error("[Optibase] Error: Element on the site is not part of any personalization. Invalid Personalization ID: ".concat(r))}else console.error("[Optibase] Error: Element on the site missing 'data-optibase-variant-id' attribute. Personalization ID: ".concat(r))})),t(s,"Found elements for Personalizations:",a),a.forEach((function(o,a){var c,u=null==e?void 0:e.find((function(e){return e.test.userFriendlyId===a}));if(u){t(s,"Handling personalization with userFriendlyId: ".concat(a,".")),u&&!u.eligible&&t(s,"Personalization is not eligible because: ".concat(u.reason));var l=[];if(2===u.test.variants.length){var d=u.test.variants.find((function(e){return e.userFriendlyId.includes("main_variant")||e.userFriendlyId.endsWith("_main")}))||u.test.variants[0],p=u.test.variants.find((function(e){return e.userFriendlyId.includes("personalized_variant")||e.userFriendlyId.endsWith("_personalized")}))||u.test.variants[1];if(d&&p)if(d.userFriendlyId!==p.userFriendlyId){var f=o.filter((function(e){return e.getAttribute("data-optibase-variant-id")===d.userFriendlyId})),h=o.filter((function(e){return e.getAttribute("data-optibase-variant-id")===p.userFriendlyId})),g=u.test.variants.find((function(e){return e.shownBefore})),v=g?o.filter((function(e){return e.getAttribute("data-optibase-variant-id")===g.userFriendlyId})):[],m=o.filter((function(e){return i.some((function(t){return e.getAttribute("data-optibase-variant-id")===t.userFriendlyVariantId&&a===t.userFriendlyTestId}))})),b=o.filter((function(e){return(null==r?void 0:r.userFriendlyVariantId)&&e.getAttribute("data-optibase-variant-id")===r.userFriendlyVariantId&&(null==u?void 0:u.test.userFriendlyId)===(null==r?void 0:r.userFriendlyTestId)})),y=!1;b.length?(t(s,"Selecting the preview variant."),y=!0,l=b):m.length?(t(s,"Selecting the forced variant."),l=m):$&&f.length?(t(s,"Selecting the main variant by default because the script is disabled."),y=!0,l=f):!(null==u?void 0:u.eligible)&&f.length?(t(s,"Selecting the main variant because personalization is not eligible."),y=!0,l=f):v.length?(t(s,"Selecting the previously shown variant: ".concat(null==g?void 0:g.userFriendlyId)),l=v):h.length>0?(l=h,t(s,"".concat(a," - Eligible, showing personalized variant."))):(console.warn("[Optibase] Warning: Personalization ".concat(a," is eligible but no personalized variant elements found on page. Falling back to main variant.")),l=f),0===l.length&&(t(s,"".concat(a," - No variant elements found. Showing main variant as fallback.")),l=f);var _=(null===(c=l[0])||void 0===c?void 0:c.getAttribute("data-optibase-variant-id"))||d.userFriendlyId;t(s,"Selected variant with userFriendlyVariantId: ".concat(_,". Elements:"),l),r||$||!(null==u?void 0:u.eligible)||y||n||ne.push({userFriendlyTestId:a,userFriendlyVariantId:_,heatmapsEnabled:null==u?void 0:u.test.heatmapsEnabled,recordingsEnabled:null==u?void 0:u.test.recordingsEnabled});for(var w=0,E=l;w<E.length;w++){var S=E[w];"none"===S.style.display&&(S.style.display="")}for(var I=0,O=o;I<O.length;I++){var x=O[I];x.getAttribute("data-optibase-variant-id")!==_&&(n?x.style.display="none":x.remove())}}else console.error("[Optibase] Error: Main and personalized variants have the same ID for ".concat(a));else console.error("[Optibase] Error: Could not identify main and personalized variants for ".concat(a,". Variant IDs: ").concat(u.test.variants.map((function(e){return e.userFriendlyId})).join(", ")))}else console.error("[Optibase] Error: Personalization must have exactly 2 variants. Found ".concat(u.test.variants.length,"."))}else console.error("[Optibase] Error: Personalization ".concat(a," not found in personalizations array"))}))}else t(s,"No elements with personalization attributes found.")}function O(e){return gn(this,arguments,void 0,(function(e,n){var r,i,s,o;return void 0===n&&(n=!0),vn(this,(function(a){switch(a.label){case 0:if(!W)throw new Error("[Optibase] publicApiKey is undefined");if(!ee)throw new Error("[Optibase] testedUserId is undefined");a.label=1;case 1:return a.trys.push([1,7,,8]),t("sendConversionEvent","Calling with body:",r={publicApiKey:W,testedUserId:ee,userFriendlyConversionId:e,originUrl:X,samePageVariants:ne}),[4,fetch("".concat(H,"/api/script/conversionEvent"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).catch((function(e){console.error("[Optibase] Error occurred while fetching conversionEvent. Details:",e)}))];case 2:return(i=a.sent())?i.ok?[3,5]:[4,i.json().catch((function(){}))]:[2];case 3:return s=a.sent(),[4,i.text().catch((function(){}))];case 4:throw a.sent(),400!==i.status||s.clientError?500===i.status?new yn("[Optibase] Response not ok when calling conversionEvent: "+(null==s?void 0:s.message)||0):new Error("[Optibase] Response not ok when calling conversionEvent: "+(null==s?void 0:s.message)||0):new yn("[Optibase] Response not ok when calling conversionEvent: "+(null==s?void 0:s.message)||0);case 5:return[4,i.json()];case 6:return t("sendConversionEvent","Response: ",a.sent()),oe=!0,n&&(ae=!0),[3,8];case 7:return(o=a.sent())instanceof yn||null==bn||bn.captureException(o),console.error("[Optibase] Error occurred while sending a conversion event. Details:",o),[3,8];case 8:return[2]}}))}))}function x(e){return gn(this,void 0,void 0,(function(){var n,r,i,c,u,l,d,p,f,h,g,v;return vn(this,(function(m){switch(m.label){case 0:if(!de)return t("sendView","Tracking not enabled, skipping view event"),[2];if(n=(null===(h=window.optibaseSubscriptionPlan)||void 0===h?void 0:h.includes("BUSINESS"))||(null===(g=window.optibaseSubscriptionPlan)||void 0===g?void 0:g.includes("PROFESSIONAL"))||(null===(v=window.optibaseSubscriptionPlan)||void 0===v?void 0:v.includes("CUSTOM")),0===ne.length&&!n)return t("sendView","No variants to send. Time to setup: ".concat(e,"ms.")),[2];if(!W)throw new Error("[Optibase] publicApiKey is undefined");if(!ee)throw new Error("[Optibase] testedUserId is undefined");m.label=1;case 1:return m.trys.push([1,7,,8]),r=s(),i=o(),c=a(),u={publicApiKey:W,testedUserId:ee,variants:ne,originUrl:X,screenSize:c,OS:i,browser:r,timeToSetup:e},window.optibaseActiveVariants=ne,F.forEach((function(e){return e(ne)})),"function"==typeof window.gtag?ne.forEach((function(e){!function(e){t("sendVariantToGA4","Sending variant ".concat(e.userFriendlyTestId+":"+e.userFriendlyVariantId," to GA4.")),window.gtag("event","optibase_variant_shown",{event_category:"optibase",event_label:e.userFriendlyTestId+":"+e.userFriendlyVariantId})}(e)})):t("sendVariantToGA4","Google Analytics (GA4) is not installed."),"undefined"!=typeof mixpanel&&"function"==typeof mixpanel.track?ne.forEach((function(e){!function(e){t("sendVariantToMixpanel","Sending variant ".concat(e.userFriendlyTestId+":"+e.userFriendlyVariantId," to Mixpanel.")),mixpanel.track("optibase_variant_shown",{testId:e.userFriendlyTestId,variantId:e.userFriendlyTestId+":"+e.userFriendlyVariantId})}(e)})):t("sendVariantToMixpanel","Mixpanel is not installed."),t("sendView","Calling with body:",u),[4,fetch("".concat(H,"/api/script/view"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}).catch((function(e){console.error("[Optibase] Error occurred while fetching view. Details:",e)}))];case 2:return(l=m.sent())?l.ok?[3,5]:[4,l.json().catch((function(){}))]:[2];case 3:return d=m.sent(),[4,l.text().catch((function(){}))];case 4:throw m.sent(),400!==l.status||d.clientError?500===l.status?new yn("[Optibase] Response not ok when calling view: "+(null==d?void 0:d.message)||0):new Error("[Optibase] Response not ok when calling view: "+(null==d?void 0:d.message)||0):new yn("[Optibase] Response not ok when calling view: "+(null==d?void 0:d.message)||0);case 5:return[4,l.json()];case 6:return t("sendView","Response:",p=m.sent()),p.viewId&&(re=p.viewId,se=Date.now(),oe=!1,ae=!1,ce=!1,T()),[3,8];case 7:return(f=m.sent())instanceof yn||null==bn||bn.captureException(f),console.error("[Optibase] Error occurred while sending a View. Details:",f),[3,8];case 8:return[2]}}))}))}function k(){if(de)if(ce)t("sendBounce","Bounce already sent, skipping.");else if(re)if(W&&ee){ce=!0;var e=Date.now()-se,n={publicApiKey:W,testedUserId:ee,viewId:re,timeOnPage:e,hadConversion:oe,hadEngagementConversion:ae,variants:ne};t("sendBounce","Sending bounce data:",n);var r=new Blob([JSON.stringify(n)],{type:"application/json"});navigator.sendBeacon("".concat(H,"/api/script/bounce"),r)||(t("sendBounce","sendBeacon failed, attempting fetch."),fetch("".concat(H,"/api/script/bounce"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),keepalive:!0}).catch((function(e){t("sendBounce","Fetch fallback also failed:",e)})))}else t("sendBounce","Missing publicApiKey or testedUserId, skipping.");else t("sendBounce","No viewId available, skipping bounce tracking.");else t("sendBounce","Tracking not enabled, skipping bounce event")}function T(){t("setupBounceTracking","Setting up bounce tracking listeners."),window.addEventListener("pagehide",(function(){t("setupBounceTracking","Page hide event."),k()})),window.addEventListener("beforeunload",(function(){t("setupBounceTracking","Before unload event."),k()}))}function C(e){t("handleClickConversions","Setting up click listeners.");var n=document.querySelectorAll("[data-optibase-click-conversion-id]");0!==n.length?(t("handleClickConversions","Found elements with click conversion attribute:",n),n.forEach((function(t){var n=t.getAttribute("data-optibase-click-conversion-id");e.find((function(e){return e.userFriendlyId===n}))?t.addEventListener("click",(function(e){return gn(this,void 0,void 0,(function(){var r,i;return vn(this,(function(s){switch(s.label){case 0:return"A"!==t.tagName?[3,2]:(e.preventDefault(),[4,O(n)]);case 1:return s.sent(),(i=(r=t).href)&&("_blank"===r.target?window.open(i,"_blank"):window.location.href=i),[3,3];case 2:O(n),s.label=3;case 3:return[2]}}))}))})):console.error('[Optibase] Error: Element with click conversion ID "'.concat(n,'" does not have a corresponding Click Conversion on the server.'))}))):t("handleClickConversions","No elements with click conversion attribute found.")}function A(e){t("handleSubmitConversions","Setting up submit listeners.");var n=document.querySelectorAll("[data-optibase-submit-conversion-id]");0!==n.length?(t("handleSubmitConversions","Found elements with submit conversion attribute:",n),n.forEach((function(n){var r=n.getAttribute("data-optibase-submit-conversion-id");if(e.find((function(e){return e.userFriendlyId===r})))if("FORM"!==n.tagName){t("handleSubmitConversions",'Element with submit conversion ID "'.concat(r,'" is not a form element. Waiting for form to be added to the DOM by adding an observer.'));var i=function(){var e=n.querySelector("form");if(!e){var i=n.querySelector("iframe");if(!i)return void t("handleSubmitConversions",'Element with submit conversion ID "'.concat(r,'" is not a form element, does not contain a form element, and is not an iframe.'));var a=i.contentDocument;if(!a)return void t("handleSubmitConversions",'[Optibase] iframe in element with submit conversion ID "'.concat(r,'" does not have a contentDocument.'));if(!(e=a.querySelector("form")))return void t("handleSubmitConversions",'[Optibase] iframe in element with submit conversion ID "'.concat(r,'" does not have a form element.'))}t("handleSubmitConversions",'Adding submit listener to the found form element for submit conversion ID "'.concat(r,'":'),e),s.disconnect(),e.addEventListener("submit",o)},s=new MutationObserver((function(e){t("handleSubmitConversions MutationObserver",'Found Mutations for submit conversion ID "'.concat(r,'":'),e),e.forEach((function(e){"childList"==e.type&&i()}))}));s.observe(n,{childList:!0,subtree:!0}),i()}else t("handleSubmitConversions",'Adding submit listener to the found form element for submit conversion ID "'.concat(r,'":'),n),n.addEventListener("submit",o);else console.error('[Optibase] Error: Element with submit conversion ID "'.concat(r,'" does not have a corresponding Submit Conversion on the server.'));function o(e){return gn(this,void 0,void 0,(function(){return vn(this,(function(i){switch(i.label){case 0:return t("handleSubmitConversions",'Handling submit event for conversion ID "'.concat(r,'".')),!n.getAttribute("action")||e.defaultPrevented?[3,2]:(e.preventDefault(),[4,O(r)]);case 1:return i.sent(),n.submit(),[3,3];case 2:O(r),i.label=3;case 3:return[2]}}))}))}}))):t("handleSubmitConversions","No elements with submit conversion attribute found.")}function D(e){var n=this;t("handlePageViewConversion","Handling page view conversions."),0!==e.length?(t("handlePageViewConversion","Found page view conversions:",e),e.forEach((function(e){return gn(n,void 0,void 0,(function(){return vn(this,(function(n){switch(n.label){case 0:return _(e.url,e.sameOrigin,e.urlMatchType)?(t("handlePageViewConversion","Sending page view conversion with userFriendlyId: ".concat(e.userFriendlyId,".")),[4,O(e.userFriendlyId,!1)]):[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))}))):t("handlePageViewConversion","No page view conversions found.")}function P(e){t("handleScrollConversions","Setting up scroll listeners.");var n=e.filter((function(e){return _(e.url,e.sameOrigin,fn.EXACT)}));if(0!==n.length){t("handleScrollConversions","Found scroll depth conversions:",n);var r=new Set;window.addEventListener("scroll",(function(){var e,i,s=(e=window.pageYOffset||document.documentElement.scrollTop,i=document.documentElement.scrollHeight,(e+window.innerHeight)/i*100);n.forEach((function(e){if(!r.has(e.userFriendlyId)){var n=function(e){var t=document.documentElement.scrollHeight;return e.scrollDepthUnit===pn.PERCENTAGE?e.scrollDepthValue:e.scrollDepthUnit===pn.PIXELS?e.scrollDepthValue/t*100:1/0}(e);s>=n&&(t("Scroll Depth Conversion Triggered","Conversion ID: ".concat(e.userFriendlyId)),O(e.userFriendlyId),r.add(e.userFriendlyId))}}))}),{passive:!0})}else t("handleScrollConversions","No scroll depth conversions found.")}function R(e){t("handleTimeOnPageConversions","Setting up time on page listeners.");var n=e.filter((function(e){return _(e.url,e.sameOrigin,fn.EXACT)}));if(0!==n.length){t("handleTimeOnPageConversions","Found time on page conversions:",n);for(var r=function(e){setTimeout((function(){t("Time On Page Conversion Triggered","Conversion ID: ".concat(e.userFriendlyId)),O(e.userFriendlyId,!1)}),1e3*e.timeOnPage)},i=0,s=n;i<s.length;i++)r(s[i])}else t("handleTimeOnPageConversions","No time on page conversions found.")}window.optibaseSendConversionEvent=function(e){return gn(this,void 0,void 0,(function(){var n;return vn(this,(function(r){switch(r.label){case 0:if(t("handleProgrammaticConversion","Handling programmatic conversion with userFriendlyConversionId: ".concat(e,".")),!window.optibaseInitialized)return console.error("[Optibase] Did not send conversion event: Optibase did not fully initialize"),[2];if(window.monthlyTestedUsersLimitReached)return console.error("[Optibase] Did not send conversion event: Monthly Tested Users limit has been reached."),[2];if(window.noTestsOrConversionsOnPage)return console.error("[Optibase] Did not send conversion event: No tests or conversions found on the page. The conversion needs to be programmatic."),[2];if(window.userNotLoggedIn7Days)return console.error("[Optibase] Did not send conversion event: The user has not logged in in the last 7 days."),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,O(e)];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),console.error("[Optibase] Error occurred while sending a conversion event. Details:",n),[3,4];case 4:return[2]}}))}))},window.optibaseSetTestedUserExternalId=function(e){return gn(this,void 0,void 0,(function(){var n,r,i,s;return vn(this,(function(o){switch(o.label){case 0:return t("setTestedUserExternalId","Setting tested user external ID:",e),window.monthlyTestedUsersLimitReached?(console.error("[Optibase] Did not set Tested User External ID: Monthly Tested Users limit has been reached."),[2]):window.userNotLoggedIn7Days?(console.error("[Optibase] Did not send conversion event: The user has not logged in in the last 7 days."),[2]):W?ee?window.optibaseInitialized?(t("setTestedUserExternalId","Calling with body:",n={publicApiKey:W,testedUserId:ee,testedUserExternalId:e}),[4,fetch("".concat(H,"/api/script/setTestedUserExternalId"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})]):(console.error("[Optibase] Did not set Tested User External ID: Optibase did not fully initialized."),[2]):(console.error("[Optibase] Did not set Tested User External ID: Tested User ID is not set. This user hasn't encountered any tests yet."),[2]):(console.error("[Optibase] Did not set Tested User External ID: Public API Key is not set."),[2]);case 1:if(!(r=o.sent()))throw new Error("[Optibase] Response not ok when calling setTestedUserExternalId: No response.");return r.ok?[3,4]:[4,r.json().catch((function(){}))];case 2:return i=o.sent(),[4,r.text().catch((function(){}))];case 3:throw o.sent(),400!==r.status||i.clientError?500===r.status?new yn("[Optibase] Response not ok when calling setTestedUserExternalId: "+(null==i?void 0:i.message)||0):new Error("[Optibase] Response not ok when calling setTestedUserExternalId: "+(null==i?void 0:i.message)||0):new yn("[Optibase] Response not ok when calling setTestedUserExternalId: "+(null==i?void 0:i.message)||0);case 4:return[4,r.json()];case 5:return s=o.sent(),te=e,window.optibaseTestedUserExternalId=e,null==N||N.setItem("optibaseTestedUserExternalId",e),t("setTestedUserExternalId","Response:",s),[2]}}))}))};var F=[];window.optibaseAddActiveVariantsListener=function(e){F.push(e),window.optibaseActiveVariants&&e(window.optibaseActiveVariants)};var N=null;try{(N=window.localStorage).getItem("optibase")}catch(e){N=null}window.optibaseScriptLoaded=!0;var L,M=null,U=!1,z=function(){var e=new URLSearchParams(window.location.search);U=Boolean(null==N?void 0:N.getItem("optibaseDebugMode")),e.has("optibaseEnableDebugMode")&&(t("getConfig","Params has optibaseEnableDebugMode; enabling debug mode."),null==N||N.setItem("optibaseDebugMode","true"),U=!0),e.has("optibaseDisableDebugMode")&&(t("getConfig","Params has optibaseDisableDebugMode; disabling debug mode."),null==N||N.removeItem("optibaseDebugMode"),U=!1);var n=null,r=[];if(e.has("optibasePreviewVariant")){var i=e.get("optibasePreviewVariant");t("getConfig","Params has optibasePreviewVariant:",i);var s=i.split(":"),o=s[0],a=s[1];o&&a?n={userFriendlyTestId:o,userFriendlyVariantId:a}:console.error('[Optibase] Error: Invalid optibasePreviewVariant format. It should be "userFriendlyTestId:userFriendlyVariantId".')}if(e.has("optibaseVariants")){var c=e.get("optibaseVariants");t("getConfig","Params has optibaseVariants:",c),c.split(";").map((function(e){return e.split(":")})).forEach((function(e){var t=e[0],n=e[1];t&&n?r.push({userFriendlyTestId:t,userFriendlyVariantId:n}):console.error('[Optibase] Error: Invalid optibaseVariants format. It should be "userFriendlyTestId:userFriendlyVariantId".')}))}var u=Boolean(null==N?void 0:N.getItem("optibaseScriptDisabled"));return e.has("optibaseDisableScript")?(t("getConfig","Params has optibaseDisableScript; disabling script."),null==N||N.setItem("optibaseScriptDisabled","true"),u=!0):e.has("optibaseEnableScript")?(t("getConfig","Params has optibaseEnableScript; enabling script."),null==N||N.removeItem("optibaseScriptDisabled"),u=!1):n&&(t("getConfig","Disabling script to show the preview variant."),u=!0),t("getConfig","Found scriptDisabled: ".concat(u,", debugMode: ").concat(U,", previewVariant:"),n,"and forcedVariants:",r),{scriptDisabled:u,previewVariant:n,forcedVariants:r}}(),$=z.scriptDisabled,j=z.previewVariant,B=z.forcedVariants;L=navigator.userAgent,Boolean(L)&&function(){if(rn instanceof RegExp)return rn;try{rn=new RegExp(" daum[ /]| deusu/|(?:^|[^g])news(?!sapphire)|(?<! (?:channel/|google/))google(?!(app|/google| pixel))|(?<! cu)bots?(?:\\b|_)|(?<!(?:lib))http|(?<![hg]m)score|(?<!cam)scan|24x7|@[a-z][\\w-]+\\.|\\(\\)|\\.com\\b|\\btime/|\\||^<|^[\\w \\.\\-\\(?:\\):%]+(?:/v?\\d+(?:\\.\\d+)?(?:\\.\\d{1,10})*?)?(?:,|$)|^[^ ]{50,}$|^\\d+\\b|^\\w*search\\b|^\\w+/[\\w\\(\\)]*$|^active|^ad muncher|^amaya|^avsdevicesdk/|^azure|^biglotron|^bot|^bw/|^clamav[ /]|^client/|^cobweb/|^custom|^ddg[_-]android|^discourse|^dispatch/\\d|^downcast/|^duckduckgo|^email|^facebook|^getright/|^gozilla/|^hobbit|^hotzonu|^hwcdn/|^igetter/|^jeode/|^jetty/|^jigsaw|^microsoft bits|^movabletype|^mozilla/\\d\\.\\d\\s[\\w\\.-]+$|^mozilla/\\d\\.\\d\\s\\(compatible;?(?:\\s\\w+\\/\\d+\\.\\d+)?\\)$|^navermailapp|^netsurf|^offline|^openai/|^owler|^php|^postman|^python|^rank|^read|^reed|^rest|^rss|^snapchat|^space bison|^svn|^swcd |^taringa|^thumbor/|^track|^w3c|^webbandit/|^webcopier|^wget|^whatsapp|^wordpress|^xenu link sleuth|^yahoo|^yandex|^zdm/\\d|^zoom marketplace/|agent|analyzer|archive|ask jeeves/teoma|audit|bit\\.ly/|bluecoat drtr|browsex|burpcollaborator|capture|catch|check\\b|checker|chrome-lighthouse|chromeframe|classifier|cloudflare|convertify|crawl|cypress/|dareboost|datanyze|dejaclick|detect|dmbrowser|download|evc-batch/|exaleadcloudview|feed|fetcher|firephp|functionize|grab|headless|httrack|hubspot marketing grader|hydra|ibisbrowser|infrawatch|insight|inspect|iplabel|java(?!;)|library|linkcheck|mail\\.ru/|manager|measure|neustar wpm|node|nutch|offbyone|onetrust|optimize|pageburst|pagespeed|parser|perl|phantomjs|pingdom|powermarks|preview|proxy|ptst[ /]\\d|retriever|rexx;|rigor|rss\\b|scrape|server|sogou|sparkler/|speedcurve|spider|splash|statuscake|supercleaner|synapse|synthetic|tools|torrent|transcoder|url|validator|virtuoso|wappalyzer|webglance|webkit2png|whatcms/|xtate/","i")}catch(e){rn=sn}return rn}().test(L)&&(t("botDetection","Detected bot user agent."),$=!0);var V=function(){var e,n,r,i=document.currentScript;if(!i)throw new Error("[Optibase] Javascript not running withing a script.");var s=null!==(n=null!==(e=i.getAttribute("public-api-key"))&&void 0!==e?e:i.getAttribute("data-public-api-key"))&&void 0!==n?n:new URL(i.src).searchParams.get("public-api-key");if(!s)throw new yn("[Optibase] Error: Missing public-api-key attribute in script tag.");var o=i.getAttribute("src");if(!o)throw new Error("[Optibase] Error: Missing src attribute in script tag.");var a=null;try{a=new URL(o)}catch(e){}if(!a)throw new yn("[Optibase] Error: Invalid src attribute in script tag. It should be a valid URL. Current is url: "+o);var c="".concat(a.protocol,"//").concat(a.hostname).concat(a.port?":"+a.port:""),u=!0;return i.async&&(console.error("[Optibase] Script is running as async. Remove async from the script."),u=!1),i.defer&&(console.error("[Optibase] Script is running as defer. Remove defer from the script."),u=!1),"HEAD"!==(null===(r=i.parentNode)||void 0===r?void 0:r.nodeName)&&(console.error("[Optibase] Script is not in the head element. Move the script to the <head> element."),u=!1),t("validateExecution","Found publicApiKey: ".concat(s,", baseApiUrl: ").concat(c,", and canHideBody: ").concat(u,".")),{publicApiKey:s,baseApiUrl:c,canHideBody:u}}(),W=V.publicApiKey,H=V.baseApiUrl,K=V.canHideBody,G=s(),Y=o(),J=a();window.optibaseScreenSize=J;var q=function(){var e,n,r;try{r=null===(n=null===(e=null===window||void 0===window?void 0:window.frames)||void 0===e?void 0:e.top)||void 0===n?void 0:n.document.referrer}catch(e){r=void 0}return t("metadata","Current Top Refferer: ".concat(r,".")),r}();ie("browser",G),ie("os",Y);var X=function(){var e=window.location.origin+window.location.pathname;return t("metadata","Current Origin Url: ".concat(e,".")),e}(),Z=u(X),Q=function(e){try{return new URL(e.startsWith("http")?e:"https://".concat(e)).pathname}catch(e){return null}}(X),ee=new URLSearchParams(window.location.search).get("optibase_uid")||(null==N?void 0:N.getItem("optibaseTestedUserId"));window.optibaseTestedUserId=ee;var te=null==N?void 0:N.getItem("optibaseTestedUserExternalId");window.optibaseTestedUserExternalId=te;var ne=[],re=null,se=Date.now(),oe=!1,ae=!1,ce=!1,ue="default",le=null,de=!1,pe=!1,fe=[],he=[],ge=!1,ve=!1;function me(e){null==N||N.setItem("optibaseConsent:".concat(W),String(e))}function be(){return gn(this,void 0,void 0,(function(){var e,n,r,i,s,o,a,c;return vn(this,(function(u){switch(u.label){case 0:if(de)return t("enableTracking","Tracking already enabled, skipping"),[2];t("enableTracking","Enabling tracking"),u.label=1;case 1:return u.trys.push([1,6,,7]),t("enableTracking","Calling with body:",e={publicApiKey:W,screenSize:J,entryUrl:X,topReferrer:q,OS:Y,browser:G,variants:fe}),[4,fetch("".concat(H,"/api/script/enableTracking"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)})];case 2:return(n=u.sent()).ok?[3,4]:[4,n.json().catch((function(){}))];case 3:return r=u.sent(),console.error("[Optibase] Error enabling tracking:",(null==r?void 0:r.message)||"Unknown error"),[2];case 4:return[4,n.json()];case 5:return i=u.sent(),s=i.testedUserId,o=i.viewId,ee=s,window.optibaseTestedUserId=s,null==N||N.setItem("optibaseTestedUserId",s),de=!0,fe.length>0&&(window.optibaseActiveVariants=fe,F.forEach((function(e){return e(fe)}))),t("enableTracking","Tracking enabled. TestedUserId: ".concat(s,", ViewId: ").concat(o)),o&&(re=o,se=null!==(c=null==M?void 0:M.getTime())&&void 0!==c?c:Date.now(),oe=!1,ce=!1,T()),he.length>0&&(C(he.filter((function(e){return e.type===dn.CLICK||e.type===dn.LEGACY_CLICK_SUBMIT}))),A(he.filter((function(e){return e.type===dn.SUBMIT||e.type===dn.LEGACY_CLICK_SUBMIT}))),P(he.filter((function(e){return e.type===dn.SCROLL_DEPTH}))),R(he.filter((function(e){return e.type===dn.TIME_ON_PAGE}))),D(he.filter((function(e){return e.type===dn.PAGE_VIEW})))),ge&&b(H,W),ve&&y(H,W),[3,7];case 6:return a=u.sent(),console.error("[Optibase] Error enabling tracking:",a),[3,7];case 7:return[2]}}))}))}function ye(){return gn(this,void 0,void 0,(function(){var e,s,o,a,c,u,l;return vn(this,(function(h){switch(h.label){case 0:return h.trys.push([0,3,,4]),t("onDOMContentLoaded","DOM Content Loaded"),M=new Date,e=document.querySelectorAll("[data-optibase-variant-id]"),s=document.querySelectorAll("[data-optibase-click-conversion-id]"),o=document.querySelectorAll("[data-optibase-submit-conversion-id]"),a=Boolean(e.length),c=Boolean(s.length)||Boolean(o.length),function(e,s){var o,a,c,u,l="optibaseCachedInitializeResponse-tests".concat(e,"-conversions").concat(s),p=null==N?void 0:N.getItem(l);if(p){var h=JSON.parse(p),m=g(h),_=v(h);if(t("handleCachedInitializeResponse","Detected cached getInitialize response for tests=".concat(e,", conversions=").concat(s,":"),h),!h.randomSeed)throw null==N||N.removeItem(l),new Error("[Optibase] Random seed not returned.");f=h.randomSeed,E((null===(o=h.tests)||void 0===o?void 0:o.filter((function(e){return e.eligible&&e.test.type===ln.SPLIT})))||[],!0,j,B)||(S((null===(a=h.tests)||void 0===a?void 0:a.filter((function(e){return e.test.type===ln.AB})))||[],!0,j,B),I(h.personalizations||[],!0,j,B),d(),$||(((null===(c=h.tests)||void 0===c?void 0:c.some((function(e){return e.test.heatmapsEnabled&&e.eligible})))||(null===(u=h.personalizations)||void 0===u?void 0:u.some((function(e){return e.test.heatmapsEnabled&&e.eligible})))||m.length>0)&&n()&&b(H,W),(i(h.tests)||i(h.personalizations)||_.length>0)&&r()&&y(H,W)))}else t("handleCachedInitializeResponse","No cached getInitialize response for tests=".concat(e,", conversions=").concat(s))}(a,c),Boolean(e.length)||t("onDOMContentLoaded","No variants found on the page."),Boolean(s.length)||t("onDOMContentLoaded","No click conversions found on the page."),Boolean(o.length)||t("onDOMContentLoaded","No submit conversions found on the page."),[4,p(a,c)];case 1:return u=h.sent(),t("getInitialize","Received response"),[4,m(u,a,c)];case 2:return h.sent(),[3,4];case 3:return(l=h.sent())instanceof yn||null==bn||bn.captureException(l),console.error("[Optibase] Encountered an error:",l),window.optibaseInitialized=!0,d(),[3,4];case 4:return[2]}}))}))}window.optibaseEnableTracking=function(){return gn(e,void 0,void 0,(function(){return vn(this,(function(e){switch(e.label){case 0:return t("optibaseEnableTracking","Called externally"),me(!0),[4,be()];case 1:return e.sent(),[2]}}))}))},K&&(t("hideBody","Hiding body."),l.innerHTML="body { visibility: hidden !important; }",document.head.appendChild(l),setTimeout((function(){d()}),5e3)),"loading"!==document.readyState?ye():document.addEventListener("DOMContentLoaded",ye)}()}catch(S){throw S instanceof yn||null==bn||bn.captureException(S),S}})();
//# sourceMappingURL=script.js.map
//# debugId=df1fd97b-9bae-55ac-8490-c8b59211ed9e
